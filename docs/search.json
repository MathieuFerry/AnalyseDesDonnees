[
  {
    "objectID": "CorrectionTD7.html",
    "href": "CorrectionTD7.html",
    "title": "TD7",
    "section": "",
    "text": "Note : ce TD comprend une partie d’exercice sur table corrigée en séance.\nLa base de données est tirée du package ade4 et présente les résultats d’une enquête menée auprès de 810 clients d’une banque. Le dictionnaire des données de la base peut être consulté ici.\n\nlibrary(readr)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(explor)\nlibrary(GDAtools)\n\nsetwd(\"E:/Enseignements/Cours UVSQ/Année 2023-2024/L3 Sociologie Analyse des données/TD/TD7\")\nenq&lt;-read_csv(\"TD7.csv\")\n\nPour réaliser l’ACM telle qu’indiquée sur l’énoncé, il faut sélectionner les variables présentes dans l’analyse.\n\nenq1&lt;-subset(enq,select=c(csp,age,sexe,\n                          assurvi,cableue,eparliv,interdit,duree,credcon,soldevu,oppo,credhab))\n\nstr(enq1)\n\ntibble [810 × 12] (S3: tbl_df/tbl/data.frame)\n $ csp     : chr [1:810] \"ouvri\" \"cadsu\" \"cadsu\" \"inact\" ...\n $ age     : chr [1:810] \"ai75\" \"ai35\" \"ai75\" \"ai45\" ...\n $ sexe    : chr [1:810] \"hom\" \"hom\" \"hom\" \"fem\" ...\n $ assurvi : chr [1:810] \"non\" \"non\" \"non\" \"non\" ...\n $ cableue : chr [1:810] \"non\" \"non\" \"non\" \"non\" ...\n $ eparliv : chr [1:810] \"nul\" \"nul\" \"nul\" \"nul\" ...\n $ interdit: chr [1:810] \"non\" \"non\" \"non\" \"oui\" ...\n $ duree   : chr [1:810] \"d48\" \"d24\" \"d48\" \"d24\" ...\n $ credcon : chr [1:810] \"nul\" \"nul\" \"nul\" \"nul\" ...\n $ soldevu : chr [1:810] \"n1\" \"n1\" \"p1\" \"p2\" ...\n $ oppo    : chr [1:810] \"non\" \"non\" \"non\" \"non\" ...\n $ credhab : chr [1:810] \"non\" \"non\" \"non\" \"non\" ...\n\n\nIl va falloir indiquer à la fonction MCA le numéro de colonne des variables supplémentaires. Ici, on a créé enq1 de telle sorte qu’elles soient dans les trois premières colonnes, donc on utilise l’argument quali.sup de la fonction MCA, où on indique le vecteur c(1,2,3).\n\nres.acm1&lt;-MCA(enq1,quali.sup=c(1,2,3),graph=F)\n\nOn peut vérifier nos résultats sur les valeurs propres que nous montrions tout à l’heure. Concernant le critère de Kaiser :\n\nres.acm1$eig[,1]&gt;mean(res.acm1$eig[,1])\n\n dim 1  dim 2  dim 3  dim 4  dim 5  dim 6  dim 7  dim 8  dim 9 dim 10 dim 11 \n  TRUE   TRUE   TRUE   TRUE   TRUE   TRUE   TRUE   TRUE  FALSE  FALSE  FALSE \ndim 12 dim 13 dim 14 dim 15 dim 16 dim 17 dim 18 \n FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE \n\n\nConcernant le critère du coude, on projette l’éboulis des valeurs propres.\n\nfviz_eig(res.acm1)\n\n\n\n\nExaminons le nuage des individus sur le premier plan. Le nuage ne semble pas présenter de forme particulière sur le premier plan de l’ACM.\n\nfviz_mca_ind(res.acm1,alpha.ind = \"contrib\",label=\"none\")\n\n\n\n\nOn regarde la projection des modalités actives qui ont une contribution supérieure à la contribution moyenne sur l’axe 1. On a un axe structuré par une opposition entre instabilité et solvabilité bancaire.\n\ncontrib1&lt;-rownames(res.acm1$var$contrib)[res.acm1$var$contrib[,1]&gt;100/nrow(res.acm1$var$contrib)]\nfviz_mca_var(res.acm1,axes=c(1,2),\n             select.var=list(name = contrib1))\n\n\n\n\nLes modalités supplémentaires significativement associées à l’axe peuvent être projetées de la manière suivante :\n\nsigsup1&lt;-rownames(res.acm1$quali.sup$v.test)[abs(res.acm1$quali.sup$v.test[,1])&gt;1.96]\nfviz_mca_var(res.acm1,axes=c(1,2),\n             select.var=list(name = sigsup1))\n\n\n\n\nIl peut être judicieux de représenter les variables actives et supplémentaires sur le même plan. A noter que les variables actives sont beaucoup plus dispersées que les variables supplémentaires, ainsi on n’“explique” pas l’entièreté de la variabilité des pratiques bancaires avec les variables sociodémographiques prises en compte ici.\n\nfviz_mca_var(res.acm1,axes=c(1,2),\n             select.var=list(name = c(sigsup1,contrib1)))\n\n\n\n\nFaisons la même chose pour l’axe 2.\n\ncontrib2&lt;-rownames(res.acm1$var$contrib)[res.acm1$var$contrib[,2]&gt;100/nrow(res.acm1$var$contrib)]\nsigsup2&lt;-rownames(res.acm1$quali.sup$v.test)[abs(res.acm1$quali.sup$v.test[,2])&gt;1.96]\nfviz_mca_var(res.acm1,axes=c(1,2),\n             select.var=list(name = c(sigsup2,contrib2)))\n\n\n\n\nCet axe oppose des emprunteurs (en haut) qui ne sont pas solvable et sont aussi plutôt interdits bancaires, à des épargnants avec beaucoup de réserve financière (et une grande ancienneté dans la banque) en bas. L’axe est surtout structuré par l’âge : on emprunte en début de cycle de vie, tandis qu’on est plus épargnants en fin de cycle de vie.\nOn projette finalement l’ensemble du nuage des variables, en distinguant l’intensité des modalités suivant la qualité de représentation des modalités.\n\nfviz_mca_var(res.acm1,axes=c(1,2),alpha.var = \"cos2\" )\n\n\n\n\nExaminons le taux modifié des premiers axes de l’ACM qui permet de mieux voir l’importance relative du premier axe. Il faut utiliser la fonction modif.rate du package GDAtools. On voit que pour le premier axe il correspond à 78% de l’information, contre 13% pour le second axe. Le premier axe structure donc très fortement les données.\n\nmrate&lt;-modif.rate(res.acm1)\nmrate$modif\n\n             mrate cum.mrate\ndim 1 78.376274789  78.37627\ndim 2 12.906256376  91.28253\ndim 3  4.672854554  95.95539\ndim 4  3.373297051  99.32868\ndim 5  0.481427051  99.81011\ndim 6  0.159532959  99.96964\ndim 7  0.026445496  99.99609\ndim 8  0.003911724 100.00000\n\n\nAppuyons-nous maintenant sur toutes les variables du fichier enq pour réaliser une seconde ACM (21 variables !).\n\nstr(enq)\n\nspc_tbl_ [810 × 21] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ csp     : chr [1:810] \"ouvri\" \"cadsu\" \"cadsu\" \"inact\" ...\n $ duree   : chr [1:810] \"d48\" \"d24\" \"d48\" \"d24\" ...\n $ oppo    : chr [1:810] \"non\" \"non\" \"non\" \"non\" ...\n $ age     : chr [1:810] \"ai75\" \"ai35\" \"ai75\" \"ai45\" ...\n $ sexe    : chr [1:810] \"hom\" \"hom\" \"hom\" \"fem\" ...\n $ interdit: chr [1:810] \"non\" \"non\" \"non\" \"oui\" ...\n $ cableue : chr [1:810] \"non\" \"non\" \"non\" \"non\" ...\n $ assurvi : chr [1:810] \"non\" \"non\" \"non\" \"non\" ...\n $ soldevu : chr [1:810] \"n1\" \"n1\" \"p1\" \"p2\" ...\n $ eparlog : chr [1:810] \"nul\" \"nul\" \"nul\" \"nul\" ...\n $ eparliv : chr [1:810] \"nul\" \"nul\" \"nul\" \"nul\" ...\n $ credhab : chr [1:810] \"non\" \"non\" \"non\" \"non\" ...\n $ credcon : chr [1:810] \"nul\" \"nul\" \"nul\" \"nul\" ...\n $ versesp : chr [1:810] \"non\" \"non\" \"non\" \"oui\" ...\n $ retresp : chr [1:810] \"fai\" \"fai\" \"fai\" \"fai\" ...\n $ remiche : chr [1:810] \"nul\" \"nul\" \"nul\" \"fai\" ...\n $ preltre : chr [1:810] \"nul\" \"nul\" \"nul\" \"nul\" ...\n $ prelfin : chr [1:810] \"nul\" \"nul\" \"nul\" \"nul\" ...\n $ viredeb : chr [1:810] \"nul\" \"nul\" \"nul\" \"nul\" ...\n $ virecre : chr [1:810] \"nul\" \"nul\" \"nul\" \"nul\" ...\n $ porttit : chr [1:810] \"nul\" \"nul\" \"nul\" \"moy\" ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   csp = col_character(),\n  ..   duree = col_character(),\n  ..   oppo = col_character(),\n  ..   age = col_character(),\n  ..   sexe = col_character(),\n  ..   interdit = col_character(),\n  ..   cableue = col_character(),\n  ..   assurvi = col_character(),\n  ..   soldevu = col_character(),\n  ..   eparlog = col_character(),\n  ..   eparliv = col_character(),\n  ..   credhab = col_character(),\n  ..   credcon = col_character(),\n  ..   versesp = col_character(),\n  ..   retresp = col_character(),\n  ..   remiche = col_character(),\n  ..   preltre = col_character(),\n  ..   prelfin = col_character(),\n  ..   viredeb = col_character(),\n  ..   virecre = col_character(),\n  ..   porttit = col_character()\n  .. )\n - attr(*, \"problems\")=&lt;externalptr&gt; \n\n\nCette fois, les variables de position sociale que nous souhaitons positionner en supplémentaire sont en position 1, 4, 5 du fichier enq.\n\nres.acm2&lt;-MCA(enq,quali.sup=c(1,4,5),graph=F)\n\nRegardons de nouveau combien d’axes analyser. D’après le critère du coude, on a plus nettement deux axes à garder ici.\n\nfviz_eig(res.acm2)\n\n\n\n\nLe nuage des individus ne semble pas non plus présenter de structure particulière. Si on pinaillait, on irait regarder la contribution des individus à l’ACM car on a l’impression que certains d’entre eux contribuent bien davantage.\n\nfviz_mca_ind(res.acm2,alpha.ind = \"contrib\",label=\"none\")\n\n\n\n\nLe premier axe, interprétation à discuter :\n\ncontrib1&lt;-rownames(res.acm2$var$contrib)[res.acm2$var$contrib[,1]&gt;100/nrow(res.acm2$var$contrib)]\nsigsup1&lt;-rownames(res.acm2$quali.sup$v.test)[abs(res.acm2$quali.sup$v.test[,1])&gt;1.96]\nfviz_mca_var(res.acm2,axes=c(1,2),\n             select.var=list(name = c(sigsup1,contrib1)))\n\n\n\n\nLe second axe, interprétation à discuter :\n\ncontrib2&lt;-rownames(res.acm2$var$contrib)[res.acm2$var$contrib[,2]&gt;100/nrow(res.acm2$var$contrib)]\nsigsup2&lt;-rownames(res.acm2$quali.sup$v.test)[abs(res.acm2$quali.sup$v.test[,2])&gt;1.96]\nfviz_mca_var(res.acm2,axes=c(1,2),\n             select.var=list(name = c(sigsup2,contrib2)))\n\n\n\n\nL’ensemble des modalités sur le premier plan factoriel, en distinguant l’opacité suivant la qualité de représentation (cos2) :\n\nfviz_mca_var(res.acm2,axes=c(1,2),alpha=\"cos2\")"
  },
  {
    "objectID": "Index.html",
    "href": "Index.html",
    "title": "Cours d’Analyse Des Données",
    "section": "",
    "text": "Cette page recense quelques éléments de corrections des Travaux Dirigés menés dans le cadre du cours d’Analyse Des Données en Licence 3 MIASHS et Sociologie à l’Université Versailles Saint-Quentin.\nLes documents de correction apparaissent ici au fur et à mesure du semestre. Pour toute question, vous pouvez m’envoyer un email !\nCertains des jeux de données utilisés sont tirés de TDs menés par Yoann Demoli et Anatole Lamy envers qui je suis éternellement reconnaissant pour leur générosité !"
  },
  {
    "objectID": "Index.html#analyse-des-données",
    "href": "Index.html#analyse-des-données",
    "title": "Cours d’Analyse Des Données",
    "section": "",
    "text": "Cette page recense quelques éléments de corrections des Travaux Dirigés menés dans le cadre du cours d’Analyse Des Données en Licence 3 MIASHS et Sociologie à l’Université Versailles Saint-Quentin.\nLes documents de correction apparaissent ici au fur et à mesure du semestre. Pour toute question, vous pouvez m’envoyer un email !\nCertains des jeux de données utilisés sont tirés de TDs menés par Yoann Demoli et Anatole Lamy envers qui je suis éternellement reconnaissant pour leur générosité !"
  },
  {
    "objectID": "CorrectionTD5.html",
    "href": "CorrectionTD5.html",
    "title": "TD5",
    "section": "",
    "text": "Les données sont extraites de l’enquête Trajectoires et Origines (2019-2020) s’intéressant en particulier aux immigrés (nommés ici « G1 ») et aux descendants d’immigrés (enfants d’un ou deux immigrés, nommés « G2 ») résidant en France métropolitaine. Les personnes originaires ou descendantes des régions d’Outre-Mer ont également été surreprésentées dans l’échantillon de l’enquête. Enfin, l’enquête a également interrogé des personnes sans ascendance migratoire (« population majoritaire »), la composition de l’échantillon permettant ainsi de comparer le poids des origines par rapport à la population qui n’a pas d’ascendance migratoire sur au moins deux générations.\nDans les données présentées (fichier « tab1.csv »), on a croisé le lien à la migration et l’origine géographique (en lignes) avec la profession, codée suivant la nomenclature des Professions et Catégories Socioprofessionnelles (en colonne).\nOn se pose la question de l’association entre origines migratoires et situation professionnelle :\n\nLes immigrés et leurs descendants, suivant leur origine géographique, ont-ils plus de chances d’appartenir à certaines professions ?\nEn particulier, sont-ils plus souvent en bas de la hiérarchie des professions ou au contraire en haut ?\nQuelles distinctions existe-t-il au sein du monde des professions qui rendent compte de la segmentation du marché du travail suivant l’origine migratoire ?\n\nLe script R « TD5.R » propose quelques lignes de commande permettant de répondre aux questions du TD et vous pouvez également vous appuyer sur les scripts de la séance précédente pour compléter ce travail.\nCeci est un corrigé rapide qui peut être complété de manière plus détaillée en examinant davantage les plans factoriels et en interprétant sociologiquement la segmentation du marché du travail. Il vise simplement à donner quelques pistes d’analyses.\n\n\nAprès avoir ouvert la base (« tab1.csv ») et fait tourner les premières lignes de commande, vous utiliserez les fonctions dim, rownames et colnames permettant de décrire les données. Vous justifierez l’adéquation entre la méthode de l’Analyse Factorielle des Correspondances (AFC) et les données ici étudiées.\n\nlibrary(readr)\nlibrary(tibble)\nlibrary(FactoMineR)\nlibrary(explor)\nlibrary(factoextra)\n\n\nsetwd(\"E:/Enseignements/Cours UVSQ/Année 2023-2024/L3 Sociologie Analyse des données/TD/TD5\")\n\ntab1&lt;-read_csv2(\"tab1.csv\")\ntab1&lt;-column_to_rownames(tab1,var=\"...1\")\n\ndim(tab1)\n\n[1] 30 25\n\nrownames(tab1)\n\n [1] \"Pop majoritaire\"                  \"G1 Outre-Mer\"                    \n [3] \"G2 Outre-Mer\"                     \"G1 Algérie\"                      \n [5] \"G2 Algérie\"                       \"G1 Maroc/Tunisie\"                \n [7] \"G2 Maroc ou de Tunisie\"           \"G1 Afrique sahélienne\"           \n [9] \"G2 Afrique sahélienne\"            \"G1 Afrique guinéenne ou centrale\"\n[11] \"G2 Afrique guinéenne ou centrale\" \"G1 autres pays d'Afrique\"        \n[13] \"G2 autres pays d'Afrique\"         \"G1 Asie du Sud-est\"              \n[15] \"G2 Asie du Sud-est\"               \"G1 Turquie ou du Moyen-Orient\"   \n[17] \"G2 Turquie ou du Moyen-Orient\"    \"G1 Chine\"                        \n[19] \"G1 autres pays d'Asie\"            \"G2 autres pays d'Asie\"           \n[21] \"G1 Portugal\"                      \"G2 Portugal\"                     \n[23] \"G1 Espagne ou d'Italie\"           \"G2 Espagne ou d'Italie\"          \n[25] \"G1 autres pays de l'UE27\"         \"G2 autres pays de l'UE27\"        \n[27] \"G1 autres pays d'Europe\"          \"G2 autres pays d'Europe\"         \n[29] \"G1 autres pays\"                   \"G2 autres pays\"                  \n\ncolnames(tab1)\n\n [1] \"Agriculteurs\"                                \n [2] \"Artisan\"                                     \n [3] \"Commerçant\"                                  \n [4] \"Chefs d’entreprise (&gt;=10 salariés)\"          \n [5] \"Professions libérales\"                       \n [6] \"Cadres fonction publique\"                    \n [7] \"Professions scientifiques\"                   \n [8] \"Professions info/arts/spectacles\"            \n [9] \"Cadres d’entreprise\"                         \n[10] \"Ingénieurs/cadres techniques d’entreprise\"   \n[11] \"Professeurs des écoles\"                      \n[12] \"Prof intermédiaires santé\"                   \n[13] \"Professions intermédiaires fonction publique\"\n[14] \"Prof intermédiaires entreprises\"             \n[15] \"Techniciens\"                                 \n[16] \"Contremaîtres\"                               \n[17] \"Employés fonction publique\"                  \n[18] \"Policiers et militaires\"                     \n[19] \"Employés d’entreprise\"                       \n[20] \"Employés de commerce\"                        \n[21] \"Personnels aux particuliers\"                 \n[22] \"Ouvriers qualif\"                             \n[23] \"Chauffeurs\"                                  \n[24] \"Ouvriers non qualif\"                         \n[25] \"Ouvriers agricoles\"                          \n\n\nLe fichier tab1 correspond à un tableau de contingence croisant en ligne le lien à la migration (immigré G1, descendant d’immigré G2 et population majoritaire avec l’origine migratoire) avec 30 modalités différentes et en colonnes les PCS avec 25 modalités différentes. Dans les cellules se trouvent les effectifs d’individus.\nCe tableau de contingence, de taille importante, est difficilement analysable facilement par le recours à des pourcentages en ligne / colonne, ou même par des représentations de type diagrammes en bâtons.\nEn revanche, il se prête bien à une analyse factorielle des correspondances (voir cours magistral pour plus de détail).\n\n\n\nRéalisez l’AFC.\nAvant toute chose, on peut déjà regarder s’il y a un lien entre l’origine migratoire et la position sur le marché du travail. On peut conduire un test statistique du chi-2 d’indépendance. Dans ce test, l’hypothèse H0 est que les deux variables sont indépendantes et l’hypothèse alternative (H1) est que les deux variables sont liées. Si la p-value associée au test statistique est faible (&lt;0.05), alors on rejette H0 et donc on rejette l’hypothèse d’indépendance entre les deux variables. Pour plus de détails sur ce test, on peut regarder cette vidéo : https://www.youtube.com/watch?v=-Xn1nmHjnHU.\n\nchisq.test(tab1)\n\nWarning in chisq.test(tab1): L’approximation du Chi-2 est peut-être incorrecte\n\n\n\n    Pearson's Chi-squared test\n\ndata:  tab1\nX-squared = 1746.6, df = 696, p-value &lt; 2.2e-16\n\n\nIci, on voit que la statistique du khi-deux est de 1747, avec 696 degrés de liberté, R nous indique que la probabilité associée que sous l’hypothèse d’indépendance on obtienne cette statistique est extrêmement faible. Donc, on rejette l’hypothèse d’indépendance, et on peut conclure qu’il y a un lien statistique entre nos deux variables étudiées.\nNote : la conduite du test renvoie un “Warning” : R nous prévient que le calcul du test n’est pas optimal car normalement on ne calcule pas la statistique du khi-deux quand il y a des cellules vides, mais nous ignorons ce potentiel problème ici.\nQuelle est l’intensité de ce lien ? On peut l’étudier grâce au V de Cramer (voir le cours magistral !). C’est la racine carrée du chi2 divisée par divisée par le nombre minimum entre les colonnes et les lignes moins 1.\n\nsqrt(1746.6/(sum(tab1)*min(nrow(tab1)-1,ncol(tab1)-1)))\n\n[1] 0.05372636\n\n\nOn peut aussi directement utiliser la fonction cramer.v qui est dans le package questionr :\n\ninstall.packages(\"questionr\", repos = \"http://cran.us.r-project.org\")\nlibrary(questionr)\ncramer.v(tab1)\n\n[1] 0.05372675\n\n\nOn a bien le même résultat V-Cramer = 0.05. Au maximum il peut être de 1, au minimum il est de 0. Comme il est &lt;0.2, on peut dire que la liaison ici est plutôt faible même si elle existe.\nOn réalise l’AFC :\n\nres.afc&lt;-CA(tab1, graph=F)\n\nLes résultats sont stockés dans l’objet res.afc qu’on va exploiter à présent.\nEn examinant les données, peut-on dire qu’il y a des associations exclusives ici qui ressortent sur l’un des axes ?\nS’il y avait une partition exclusive des lignes et des colonnes en deux classes (dans le tableau, il y aurait beaucoup de 0 pour certaines cellules), la première valeur propre serait de 1 (ou proche).\n\nres.afc$eig[1,]\n\n                       eigenvalue            percentage of variance \n                       0.02418766                       34.91416148 \ncumulative percentage of variance \n                      34.91416148 \n\n\nIci, la première valeur propre est égale à 0.02, donc il n’y a pas de partition exclusive dans les données qui ressort dans l’AFC.\nCombien d’axes peut-on interpréter dans cette analyse ? Vous comparerez le critère du coude à la règle de Kaiser.\nPour le critère de Kaiser, on regarde les valeurs propres qui ont une valeur supérieure à la valeur propre moyenne :\n\nvp&lt;-res.afc$eig\n# On regarde lesquelles sont supérieures à l'inertie moyenne\nvp[,1]&gt;mean(vp[,1])\n\n dim 1  dim 2  dim 3  dim 4  dim 5  dim 6  dim 7  dim 8  dim 9 dim 10 dim 11 \n  TRUE   TRUE   TRUE   TRUE   TRUE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE \ndim 12 dim 13 dim 14 dim 15 dim 16 dim 17 dim 18 dim 19 dim 20 dim 21 dim 22 \n FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE \ndim 23 dim 24 \n FALSE  FALSE \n\n\nCela nous pousserait à examiner 5 axes.\nPour le critère du coude, on peut regarder l’histogramme des valeurs propres :\n\n##Le scree plot des valeurs propres\nfviz_eig(res.afc,addlabels=T,ncp =24)\n\n\n\n\nOn a un premier décrochage entre la première et seconde dimension de l’AFC : la première est prépondérante. Ensuite un décrochage entre la troisième et quatrième : il semble que trois axes aient une valeur propre importante. Par facilité, on va ici se concentrer sur ces trois premiers axes.\n\nsum(vp[1:3,2])\n\n[1] 66.34759\n\nsum(vp[1:4,2])\n\n[1] 74.22648\n\n\nCes trois premiers axes synthétisent les deux tiers des associations entre l’origine migratoire et la position sur le marché du travail, ce qui semble vraiment pas mal ! Si on poussait jusqu’à 4 axes, on synthétiserait les trois-quarts des associations. On regarde les trois premiers, et on verra si le quatrième est interprétable… Ensuite, l’information est plus négligeable.\n\n\n\nAprès avoir déterminé le nombre d’axes à interpréter, vous les interpréterez.\n\n##Regarder les profils lignes et les profils colonnes qui contribuent le plus à l'axe 1\n#On n'affiche que les 10 premiers pour plus de lisibilité\nfviz_contrib(res.afc,choice=\"row\",axes =1,top=10)\n\n\n\nfviz_contrib(res.afc,choice=\"col\",axes =1,top=10)\n\n\n\n\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur l'axe 1. \nrowcontrib1&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,1]&gt;100/nrow(tab1)]\ncolcontrib1&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,1]&gt;100/ncol(tab1)]\nfviz_ca_biplot(res.afc,axes=c(1,2),\n               select.row = list(name = rowcontrib1),\n               select.col=list(name=colcontrib1))\n\n\n\n\nL’axe 1 (35 % de l’inertie totale) recouvre principalement à gauche les ouvriers (qualifiés et non qualifiés) et les personnels aux particuliers ainsi que les immigrés du Portugal, du Maghreb et d’Afrique. Ces profils s’opposent à droite aux professions intermédiaires et aux professeurs des écoles qui sont associés à la population majoritaire. Cet axe dénote la position subalterne des immigrés de quasiment toutes les origines (mais pas européennes à part pour les Portugais), qu’on retrouve davantage dans les emplois du bas de la hiérarchie sociale, par rapport à la population majoritaire qui ont une position plus élevée dans la hiérarchie sociale (cela étant, notons que la population majoritaire n’est pas particulièrement associée ici aux positions les plus élevées dans la hiérarchie des PCS, notamment les cadres).\n\n##Regarder les profils lignes et les profils colonnes qui contribuent le plus à l'axe 2\n#On n'affiche que les 10 premiers pour plus de lisibilité\nfviz_contrib(res.afc,choice=\"row\",axes =2,top=10)\n\n\n\nfviz_contrib(res.afc,choice=\"col\",axes =2,top=10)\n\n\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur l'axe 2. \nrowcontrib2&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,2]&gt;100/nrow(tab1)]\ncolcontrib2&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,2]&gt;100/ncol(tab1)]\nfviz_ca_biplot(res.afc,axes=c(1,2),\n               select.row = list(name = rowcontrib2),\n               select.col=list(name=colcontrib2))\n\n\n\n\nL’axe 2 (vertical) oppose en haut les ouvriers qualifiés, contremaitres, et agriculteurs, associées à la population majoritaire, par rapport à en bas les employés d’entreprise, de commerce et cadres d’entreprises associés aux immigrés des autres pays (européens notamment) et aux descendants d’immigrés de plusieurs origines. Ici, le bas de la hiérarchie sociale semble plutôt associé à la population majoritaire : il ne faut en effet pas oublier que sans ascendance migratoire, on peut aussi être dans les catégories socioprofessionnelles les plus basses, tandis que les immigrés (non racialisés ?) et les enfants d’immigrés ont tendance à avoir en moyenne une position plus typiquement associés à une position un peu plus élevée dans la hiérarchie sociale, mais dans le pôle “privé” : on ne retrouve en effet pas d’employés du public en bas de l’axe. On peut se demander dans quelle mesure cet axe ne recouvre pas une opposition entre les populations rurales (en haut) et urbaines (en bas).\n\n##Regarder les profils lignes et les profils colonnes qui contribuent le plus à l'axe 3\n#On n'affiche que les 10 premiers pour plus de lisibilité\nfviz_contrib(res.afc,choice=\"row\",axes =3,top=10)\n\n\n\nfviz_contrib(res.afc,choice=\"col\",axes =3,top=10)\n\n\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur l'axe 3 \nrowcontrib3&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,3]&gt;100/nrow(tab1)]\ncolcontrib3&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,3]&gt;100/ncol(tab1)]\nfviz_ca_biplot(res.afc,axes=c(1,3),\n               select.row = list(name = rowcontrib3),\n               select.col=list(name=colcontrib3))\n\n\n\n\nL’axe 3 toujours représenté de manière verticale dénote ici une particularité du marché du travail en bas pour les immigrés d’Afrique guinéenne/centrale, les ultra-marins et leurs descendants, et les descendants d’immigrés algériens et d’Afrique sahélienne qui ont des positions d’emploi spécifiquement associés à la “petite fonction publique” ou à la fonction publique policière.\nOn laisse de côté les autres axes (axe 4 : spécificité des immigrés d’autres pays dans les emplois d’ingénieurs =&gt; immigration du “brain drain” possiblement).\nL’AFC conduit donc à identifier des spécificités de la position des immigrés et des descendants d’immigrés sur le marché du travail par rapport à la population majoritaire : position plus subalterne pour les immigrés, davantage dans le pôle privé (urbain ?) pour les descendants et dans la petite fonction publique ou policière pour les “racisés”. Notons qu’on ne retrouve pas forcément de proximité entre immigrés et descendants d’une même origine : il semble qu’il y ait des effets liés à l’immigration de la position sur le marché du travail, mais pas forcément de “niche” identifiée où une même origine (immigrés comme descendants) seraient cantonnés à un segment particulier du marché du travail (on peut nuancer cette remarque par rapport à l’axe 3 en ne regardant pas seulement les profils-lignes les plus contributeurs, par exemple avec la fonction explor).\nBien sur, cette analyse est ici conduite rapidement et on pourrait creuser l’analyse de manière plus attentive !\n\n\n\nA votre avis, pourquoi les profils-lignes sont-ils plus éloignés de l’origine par rapport aux profils-colonnes ? Piste : vous conduirez la même AFC en mettant en ligne supplémentaire le profil-ligne de la « population majoritaire ».\nCette question appelle plusieurs observations :\n\nLes profils-lignes correspondent à l’origine migratoire et la modalité de la population majoritaire est souvent plus proche du centre des axes par rapport aux immigrés et descendants d’immigrés qui sont davantage éclatés sur les axes.\nNumériquement, la population majoritaire est bien plus importante que celle des immigrés et des descendants : on peut le calculer avec les lignes de code ci-dessous, cette population correspond aux trois-quarts de la population.\nLa centralité de la population majoritaire et la dispersion des autres groupes est donc en fait avant tout le résultat de cette configuration démographique !\nEgalement, la population majoritaire est représentée dans à peu près tous les groupes de PCS : ce n’est pas le cas des immigrés et des descendants qui numériquement plus faibles ressortent dans des segments spécifiques du marché du travail.\n\n\nmytable&lt;-as.table(as.matrix(tab1))\n\n\ndata.frame(round(prop.table(margin.table(mytable, 1))*100,1)) # A frequencies (summed over B)\n\n                               Var1 Freq\n1                   Pop majoritaire 74.3\n2                      G1 Outre-Mer  1.1\n3                      G2 Outre-Mer  1.2\n4                        G1 Algérie  1.7\n5                        G2 Algérie  2.1\n6                  G1 Maroc/Tunisie  2.2\n7            G2 Maroc ou de Tunisie  2.0\n8             G1 Afrique sahélienne  0.7\n9             G2 Afrique sahélienne  0.4\n10 G1 Afrique guinéenne ou centrale  1.1\n11 G2 Afrique guinéenne ou centrale  0.3\n12         G1 autres pays d'Afrique  0.6\n13         G2 autres pays d'Afrique  0.3\n14               G1 Asie du Sud-est  0.3\n15               G2 Asie du Sud-est  0.4\n16    G1 Turquie ou du Moyen-Orient  0.8\n17    G2 Turquie ou du Moyen-Orient  0.4\n18                         G1 Chine  0.3\n19            G1 autres pays d'Asie  0.6\n20            G2 autres pays d'Asie  0.1\n21                      G1 Portugal  1.0\n22                      G2 Portugal  1.7\n23           G1 Espagne ou d'Italie  0.5\n24           G2 Espagne ou d'Italie  2.1\n25         G1 autres pays de l'UE27  1.1\n26         G2 autres pays de l'UE27  0.8\n27          G1 autres pays d'Europe  1.0\n28          G2 autres pays d'Europe  0.2\n29                   G1 autres pays  0.6\n30                   G2 autres pays  0.1\n\ndata.frame(round(prop.table(margin.table(mytable, 2))*100,1))  # B frequencies (summed over A)\n\n                                           Var1 Freq\n1                                  Agriculteurs  1.0\n2                                       Artisan  2.6\n3                                    Commerçant  2.3\n4            Chefs d’entreprise (&gt;=10 salariés)  0.6\n5                         Professions libérales  1.9\n6                      Cadres fonction publique  2.0\n7                     Professions scientifiques  1.7\n8              Professions info/arts/spectacles  1.2\n9                           Cadres d’entreprise  4.7\n10    Ingénieurs/cadres techniques d’entreprise  5.6\n11                       Professeurs des écoles  4.1\n12                    Prof intermédiaires santé  5.5\n13 Professions intermédiaires fonction publique  1.6\n14              Prof intermédiaires entreprises  7.9\n15                                  Techniciens  4.6\n16                                Contremaîtres  2.9\n17                   Employés fonction publique  8.3\n18                      Policiers et militaires  2.0\n19                        Employés d’entreprise  5.0\n20                         Employés de commerce  5.0\n21                  Personnels aux particuliers  7.4\n22                              Ouvriers qualif 11.3\n23                                   Chauffeurs  2.9\n24                          Ouvriers non qualif  7.1\n25                           Ouvriers agricoles  1.0\n\n\nOn peut creuser cette analyse en retirant la population majoritaire de l’analyse, par exemple en mettant ce profil-ligne en supplémentaire. En ce cas, on étudie la segmentation du marché du travail en regardant les immigrés et les descendants les uns par rapport aux autres et non par rapport à la population majoritaire.\n\nres.afc2&lt;-CA(tab1,row.sup=1,graph=F)\n\nrowcontrib1&lt;-rownames(res.afc2$row$contrib)[res.afc2$row$contrib[,1]&gt;100/nrow(tab1)]\ncolcontrib1&lt;-rownames(res.afc2$col$contrib)[res.afc2$col$contrib[,1]&gt;100/ncol(tab1)]\nfviz_ca_biplot(res.afc2,axes=c(1,2),\n               select.row = list(name = rowcontrib1),\n               select.col=list(name=colcontrib1))\n\n\n\nrowcontrib2&lt;-rownames(res.afc2$row$contrib)[res.afc2$row$contrib[,2]&gt;100/nrow(tab1)]\ncolcontrib2&lt;-rownames(res.afc2$col$contrib)[res.afc2$col$contrib[,2]&gt;100/ncol(tab1)]\nfviz_ca_biplot(res.afc2,axes=c(1,2),\n               select.row = list(name = rowcontrib2),\n               select.col=list(name=colcontrib2))\n\n\n\n\n\n\n\nOuvrez le fichier « tab2.csv ». Ce fichier contient des profils-colonnes supplémentaires renseignant le niveau de diplôme des profils-lignes. Vous conduirez une AFC où ces colonnes sont mises en « profils-lignes supplémentaires ». L’une des dimensions de segmentation du marché du travail suivant le lien à la migration est-elle associée au niveau de diplôme ?  \nLes colonnes supplémentaires sont entre les positions 26 et 33, ce qu’il faut indiquer dans la fonction CA.\nNote : ici, on inclut la population majoritaire comme profil-ligne actif.\nAvec la fonction fviz_ca_col, on voit bien que le premier axe oppose très clairement les non-diplômés aux autres. Sur le deuxième et troisième axe, le diplôme est moins structurant mais les plus diplômés ressortent quand même (en bas sur le 2e et en haut sur le 3e).\n\n###Intégrer des colonnes supplémentaires à l'analyse\nsetwd(\"E:/Enseignements/Cours UVSQ/Année 2023-2024/L3 Sociologie Analyse des données/TD/TD5\")\n\ntab2&lt;-read_csv2(\"tab2.csv\")\n\nℹ Using \"','\" as decimal and \"'.'\" as grouping mark. Use `read_delim()` for more control.\n\n\nNew names:\nRows: 30 Columns: 34\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \";\" chr\n(1): ...1 dbl (33): Agriculteurs, Artisan, Commerçant, Chefs d’entreprise (&gt;=10\nsalari...\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -&gt; `...1`\n\ntab2&lt;-column_to_rownames(tab2,var=\"...1\")\n\nrownames(tab2)\n\n [1] \"Pop majoritaire\"                  \"G1 Outre-Mer\"                    \n [3] \"G2 Outre-Mer\"                     \"G1 Algérie\"                      \n [5] \"G2 Algérie\"                       \"G1 Maroc/Tunisie\"                \n [7] \"G2 Maroc ou de Tunisie\"           \"G1 Afrique sahélienne\"           \n [9] \"G2 Afrique sahélienne\"            \"G1 Afrique guinéenne ou centrale\"\n[11] \"G2 Afrique guinéenne ou centrale\" \"G1 autres pays d'Afrique\"        \n[13] \"G2 autres pays d'Afrique\"         \"G1 Asie du Sud-est\"              \n[15] \"G2 Asie du Sud-est\"               \"G1 Turquie ou du Moyen-Orient\"   \n[17] \"G2 Turquie ou du Moyen-Orient\"    \"G1 Chine\"                        \n[19] \"G1 autres pays d'Asie\"            \"G2 autres pays d'Asie\"           \n[21] \"G1 Portugal\"                      \"G2 Portugal\"                     \n[23] \"G1 Espagne ou d'Italie\"           \"G2 Espagne ou d'Italie\"          \n[25] \"G1 autres pays de l'UE27\"         \"G2 autres pays de l'UE27\"        \n[27] \"G1 autres pays d'Europe\"          \"G2 autres pays d'Europe\"         \n[29] \"G1 autres pays\"                   \"G2 autres pays\"                  \n\ncolnames(tab2)\n\n [1] \"Agriculteurs\"                                \n [2] \"Artisan\"                                     \n [3] \"Commerçant\"                                  \n [4] \"Chefs d’entreprise (&gt;=10 salariés)\"          \n [5] \"Professions libérales\"                       \n [6] \"Cadres fonction publique\"                    \n [7] \"Professions scientifiques\"                   \n [8] \"Professions info/arts/spectacles\"            \n [9] \"Cadres d’entreprise\"                         \n[10] \"Ingénieurs/cadres techniques d’entreprise\"   \n[11] \"Professeurs des écoles\"                      \n[12] \"Prof intermédiaires santé\"                   \n[13] \"Professions intermédiaires fonction publique\"\n[14] \"Prof intermédiaires entreprises\"             \n[15] \"Techniciens\"                                 \n[16] \"Contremaîtres\"                               \n[17] \"Employés fonction publique\"                  \n[18] \"Policiers et militaires\"                     \n[19] \"Employés d’entreprise\"                       \n[20] \"Employés de commerce\"                        \n[21] \"Personnels aux particuliers\"                 \n[22] \"Ouvriers qualif\"                             \n[23] \"Chauffeurs\"                                  \n[24] \"Ouvriers non qualif\"                         \n[25] \"Ouvriers agricoles\"                          \n[26] \"Aucun diplôme\"                               \n[27] \"CEP\"                                         \n[28] \"Brevet collège\"                              \n[29] \"CAP,BEP\"                                     \n[30] \"Bac techno/pro\"                              \n[31] \"Bac général\"                                 \n[32] \"Bac+1/+2\"                                    \n[33] \"Bac&gt;=+3\"                                     \n\nres.afc3&lt;-CA(tab2,col.sup=26:33,graph=F)\n\nfviz_ca_col(res.afc3,axes=c(1,2),label=\"col.sup\")\n\n\n\nfviz_ca_col(res.afc3,axes=c(1,3),label=\"col.sup\")"
  },
  {
    "objectID": "CorrectionTD5.html#question-1",
    "href": "CorrectionTD5.html#question-1",
    "title": "TD5",
    "section": "",
    "text": "Après avoir ouvert la base (« tab1.csv ») et fait tourner les premières lignes de commande, vous utiliserez les fonctions dim, rownames et colnames permettant de décrire les données. Vous justifierez l’adéquation entre la méthode de l’Analyse Factorielle des Correspondances (AFC) et les données ici étudiées.\n\nlibrary(readr)\nlibrary(tibble)\nlibrary(FactoMineR)\nlibrary(explor)\nlibrary(factoextra)\n\n\nsetwd(\"E:/Enseignements/Cours UVSQ/Année 2023-2024/L3 Sociologie Analyse des données/TD/TD5\")\n\ntab1&lt;-read_csv2(\"tab1.csv\")\ntab1&lt;-column_to_rownames(tab1,var=\"...1\")\n\ndim(tab1)\n\n[1] 30 25\n\nrownames(tab1)\n\n [1] \"Pop majoritaire\"                  \"G1 Outre-Mer\"                    \n [3] \"G2 Outre-Mer\"                     \"G1 Algérie\"                      \n [5] \"G2 Algérie\"                       \"G1 Maroc/Tunisie\"                \n [7] \"G2 Maroc ou de Tunisie\"           \"G1 Afrique sahélienne\"           \n [9] \"G2 Afrique sahélienne\"            \"G1 Afrique guinéenne ou centrale\"\n[11] \"G2 Afrique guinéenne ou centrale\" \"G1 autres pays d'Afrique\"        \n[13] \"G2 autres pays d'Afrique\"         \"G1 Asie du Sud-est\"              \n[15] \"G2 Asie du Sud-est\"               \"G1 Turquie ou du Moyen-Orient\"   \n[17] \"G2 Turquie ou du Moyen-Orient\"    \"G1 Chine\"                        \n[19] \"G1 autres pays d'Asie\"            \"G2 autres pays d'Asie\"           \n[21] \"G1 Portugal\"                      \"G2 Portugal\"                     \n[23] \"G1 Espagne ou d'Italie\"           \"G2 Espagne ou d'Italie\"          \n[25] \"G1 autres pays de l'UE27\"         \"G2 autres pays de l'UE27\"        \n[27] \"G1 autres pays d'Europe\"          \"G2 autres pays d'Europe\"         \n[29] \"G1 autres pays\"                   \"G2 autres pays\"                  \n\ncolnames(tab1)\n\n [1] \"Agriculteurs\"                                \n [2] \"Artisan\"                                     \n [3] \"Commerçant\"                                  \n [4] \"Chefs d’entreprise (&gt;=10 salariés)\"          \n [5] \"Professions libérales\"                       \n [6] \"Cadres fonction publique\"                    \n [7] \"Professions scientifiques\"                   \n [8] \"Professions info/arts/spectacles\"            \n [9] \"Cadres d’entreprise\"                         \n[10] \"Ingénieurs/cadres techniques d’entreprise\"   \n[11] \"Professeurs des écoles\"                      \n[12] \"Prof intermédiaires santé\"                   \n[13] \"Professions intermédiaires fonction publique\"\n[14] \"Prof intermédiaires entreprises\"             \n[15] \"Techniciens\"                                 \n[16] \"Contremaîtres\"                               \n[17] \"Employés fonction publique\"                  \n[18] \"Policiers et militaires\"                     \n[19] \"Employés d’entreprise\"                       \n[20] \"Employés de commerce\"                        \n[21] \"Personnels aux particuliers\"                 \n[22] \"Ouvriers qualif\"                             \n[23] \"Chauffeurs\"                                  \n[24] \"Ouvriers non qualif\"                         \n[25] \"Ouvriers agricoles\"                          \n\n\nLe fichier tab1 correspond à un tableau de contingence croisant en ligne le lien à la migration (immigré G1, descendant d’immigré G2 et population majoritaire avec l’origine migratoire) avec 30 modalités différentes et en colonnes les PCS avec 25 modalités différentes. Dans les cellules se trouvent les effectifs d’individus.\nCe tableau de contingence, de taille importante, est difficilement analysable facilement par le recours à des pourcentages en ligne / colonne, ou même par des représentations de type diagrammes en bâtons.\nEn revanche, il se prête bien à une analyse factorielle des correspondances (voir cours magistral pour plus de détail)."
  },
  {
    "objectID": "CorrectionTD5.html#question-2",
    "href": "CorrectionTD5.html#question-2",
    "title": "TD5",
    "section": "",
    "text": "Réalisez l’AFC.\nAvant toute chose, on peut déjà regarder s’il y a un lien entre l’origine migratoire et la position sur le marché du travail. On peut conduire un test statistique du chi-2 d’indépendance. Dans ce test, l’hypothèse H0 est que les deux variables sont indépendantes et l’hypothèse alternative (H1) est que les deux variables sont liées. Si la p-value associée au test statistique est faible (&lt;0.05), alors on rejette H0 et donc on rejette l’hypothèse d’indépendance entre les deux variables. Pour plus de détails sur ce test, on peut regarder cette vidéo : https://www.youtube.com/watch?v=-Xn1nmHjnHU.\n\nchisq.test(tab1)\n\nWarning in chisq.test(tab1): L’approximation du Chi-2 est peut-être incorrecte\n\n\n\n    Pearson's Chi-squared test\n\ndata:  tab1\nX-squared = 1746.6, df = 696, p-value &lt; 2.2e-16\n\n\nIci, on voit que la statistique du khi-deux est de 1747, avec 696 degrés de liberté, R nous indique que la probabilité associée que sous l’hypothèse d’indépendance on obtienne cette statistique est extrêmement faible. Donc, on rejette l’hypothèse d’indépendance, et on peut conclure qu’il y a un lien statistique entre nos deux variables étudiées.\nNote : la conduite du test renvoie un “Warning” : R nous prévient que le calcul du test n’est pas optimal car normalement on ne calcule pas la statistique du khi-deux quand il y a des cellules vides, mais nous ignorons ce potentiel problème ici.\nQuelle est l’intensité de ce lien ? On peut l’étudier grâce au V de Cramer (voir le cours magistral !). C’est la racine carrée du chi2 divisée par divisée par le nombre minimum entre les colonnes et les lignes moins 1.\n\nsqrt(1746.6/(sum(tab1)*min(nrow(tab1)-1,ncol(tab1)-1)))\n\n[1] 0.05372636\n\n\nOn peut aussi directement utiliser la fonction cramer.v qui est dans le package questionr :\n\ninstall.packages(\"questionr\", repos = \"http://cran.us.r-project.org\")\nlibrary(questionr)\ncramer.v(tab1)\n\n[1] 0.05372675\n\n\nOn a bien le même résultat V-Cramer = 0.05. Au maximum il peut être de 1, au minimum il est de 0. Comme il est &lt;0.2, on peut dire que la liaison ici est plutôt faible même si elle existe.\nOn réalise l’AFC :\n\nres.afc&lt;-CA(tab1, graph=F)\n\nLes résultats sont stockés dans l’objet res.afc qu’on va exploiter à présent.\nEn examinant les données, peut-on dire qu’il y a des associations exclusives ici qui ressortent sur l’un des axes ?\nS’il y avait une partition exclusive des lignes et des colonnes en deux classes (dans le tableau, il y aurait beaucoup de 0 pour certaines cellules), la première valeur propre serait de 1 (ou proche).\n\nres.afc$eig[1,]\n\n                       eigenvalue            percentage of variance \n                       0.02418766                       34.91416148 \ncumulative percentage of variance \n                      34.91416148 \n\n\nIci, la première valeur propre est égale à 0.02, donc il n’y a pas de partition exclusive dans les données qui ressort dans l’AFC.\nCombien d’axes peut-on interpréter dans cette analyse ? Vous comparerez le critère du coude à la règle de Kaiser.\nPour le critère de Kaiser, on regarde les valeurs propres qui ont une valeur supérieure à la valeur propre moyenne :\n\nvp&lt;-res.afc$eig\n# On regarde lesquelles sont supérieures à l'inertie moyenne\nvp[,1]&gt;mean(vp[,1])\n\n dim 1  dim 2  dim 3  dim 4  dim 5  dim 6  dim 7  dim 8  dim 9 dim 10 dim 11 \n  TRUE   TRUE   TRUE   TRUE   TRUE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE \ndim 12 dim 13 dim 14 dim 15 dim 16 dim 17 dim 18 dim 19 dim 20 dim 21 dim 22 \n FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE \ndim 23 dim 24 \n FALSE  FALSE \n\n\nCela nous pousserait à examiner 5 axes.\nPour le critère du coude, on peut regarder l’histogramme des valeurs propres :\n\n##Le scree plot des valeurs propres\nfviz_eig(res.afc,addlabels=T,ncp =24)\n\n\n\n\nOn a un premier décrochage entre la première et seconde dimension de l’AFC : la première est prépondérante. Ensuite un décrochage entre la troisième et quatrième : il semble que trois axes aient une valeur propre importante. Par facilité, on va ici se concentrer sur ces trois premiers axes.\n\nsum(vp[1:3,2])\n\n[1] 66.34759\n\nsum(vp[1:4,2])\n\n[1] 74.22648\n\n\nCes trois premiers axes synthétisent les deux tiers des associations entre l’origine migratoire et la position sur le marché du travail, ce qui semble vraiment pas mal ! Si on poussait jusqu’à 4 axes, on synthétiserait les trois-quarts des associations. On regarde les trois premiers, et on verra si le quatrième est interprétable… Ensuite, l’information est plus négligeable."
  },
  {
    "objectID": "CorrectionTD5.html#question-3",
    "href": "CorrectionTD5.html#question-3",
    "title": "TD5",
    "section": "",
    "text": "Après avoir déterminé le nombre d’axes à interpréter, vous les interpréterez.\n\n##Regarder les profils lignes et les profils colonnes qui contribuent le plus à l'axe 1\n#On n'affiche que les 10 premiers pour plus de lisibilité\nfviz_contrib(res.afc,choice=\"row\",axes =1,top=10)\n\n\n\nfviz_contrib(res.afc,choice=\"col\",axes =1,top=10)\n\n\n\n\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur l'axe 1. \nrowcontrib1&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,1]&gt;100/nrow(tab1)]\ncolcontrib1&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,1]&gt;100/ncol(tab1)]\nfviz_ca_biplot(res.afc,axes=c(1,2),\n               select.row = list(name = rowcontrib1),\n               select.col=list(name=colcontrib1))\n\n\n\n\nL’axe 1 (35 % de l’inertie totale) recouvre principalement à gauche les ouvriers (qualifiés et non qualifiés) et les personnels aux particuliers ainsi que les immigrés du Portugal, du Maghreb et d’Afrique. Ces profils s’opposent à droite aux professions intermédiaires et aux professeurs des écoles qui sont associés à la population majoritaire. Cet axe dénote la position subalterne des immigrés de quasiment toutes les origines (mais pas européennes à part pour les Portugais), qu’on retrouve davantage dans les emplois du bas de la hiérarchie sociale, par rapport à la population majoritaire qui ont une position plus élevée dans la hiérarchie sociale (cela étant, notons que la population majoritaire n’est pas particulièrement associée ici aux positions les plus élevées dans la hiérarchie des PCS, notamment les cadres).\n\n##Regarder les profils lignes et les profils colonnes qui contribuent le plus à l'axe 2\n#On n'affiche que les 10 premiers pour plus de lisibilité\nfviz_contrib(res.afc,choice=\"row\",axes =2,top=10)\n\n\n\nfviz_contrib(res.afc,choice=\"col\",axes =2,top=10)\n\n\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur l'axe 2. \nrowcontrib2&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,2]&gt;100/nrow(tab1)]\ncolcontrib2&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,2]&gt;100/ncol(tab1)]\nfviz_ca_biplot(res.afc,axes=c(1,2),\n               select.row = list(name = rowcontrib2),\n               select.col=list(name=colcontrib2))\n\n\n\n\nL’axe 2 (vertical) oppose en haut les ouvriers qualifiés, contremaitres, et agriculteurs, associées à la population majoritaire, par rapport à en bas les employés d’entreprise, de commerce et cadres d’entreprises associés aux immigrés des autres pays (européens notamment) et aux descendants d’immigrés de plusieurs origines. Ici, le bas de la hiérarchie sociale semble plutôt associé à la population majoritaire : il ne faut en effet pas oublier que sans ascendance migratoire, on peut aussi être dans les catégories socioprofessionnelles les plus basses, tandis que les immigrés (non racialisés ?) et les enfants d’immigrés ont tendance à avoir en moyenne une position plus typiquement associés à une position un peu plus élevée dans la hiérarchie sociale, mais dans le pôle “privé” : on ne retrouve en effet pas d’employés du public en bas de l’axe. On peut se demander dans quelle mesure cet axe ne recouvre pas une opposition entre les populations rurales (en haut) et urbaines (en bas).\n\n##Regarder les profils lignes et les profils colonnes qui contribuent le plus à l'axe 3\n#On n'affiche que les 10 premiers pour plus de lisibilité\nfviz_contrib(res.afc,choice=\"row\",axes =3,top=10)\n\n\n\nfviz_contrib(res.afc,choice=\"col\",axes =3,top=10)\n\n\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur l'axe 3 \nrowcontrib3&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,3]&gt;100/nrow(tab1)]\ncolcontrib3&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,3]&gt;100/ncol(tab1)]\nfviz_ca_biplot(res.afc,axes=c(1,3),\n               select.row = list(name = rowcontrib3),\n               select.col=list(name=colcontrib3))\n\n\n\n\nL’axe 3 toujours représenté de manière verticale dénote ici une particularité du marché du travail en bas pour les immigrés d’Afrique guinéenne/centrale, les ultra-marins et leurs descendants, et les descendants d’immigrés algériens et d’Afrique sahélienne qui ont des positions d’emploi spécifiquement associés à la “petite fonction publique” ou à la fonction publique policière.\nOn laisse de côté les autres axes (axe 4 : spécificité des immigrés d’autres pays dans les emplois d’ingénieurs =&gt; immigration du “brain drain” possiblement).\nL’AFC conduit donc à identifier des spécificités de la position des immigrés et des descendants d’immigrés sur le marché du travail par rapport à la population majoritaire : position plus subalterne pour les immigrés, davantage dans le pôle privé (urbain ?) pour les descendants et dans la petite fonction publique ou policière pour les “racisés”. Notons qu’on ne retrouve pas forcément de proximité entre immigrés et descendants d’une même origine : il semble qu’il y ait des effets liés à l’immigration de la position sur le marché du travail, mais pas forcément de “niche” identifiée où une même origine (immigrés comme descendants) seraient cantonnés à un segment particulier du marché du travail (on peut nuancer cette remarque par rapport à l’axe 3 en ne regardant pas seulement les profils-lignes les plus contributeurs, par exemple avec la fonction explor).\nBien sur, cette analyse est ici conduite rapidement et on pourrait creuser l’analyse de manière plus attentive !"
  },
  {
    "objectID": "CorrectionTD5.html#question-4",
    "href": "CorrectionTD5.html#question-4",
    "title": "TD5",
    "section": "",
    "text": "A votre avis, pourquoi les profils-lignes sont-ils plus éloignés de l’origine par rapport aux profils-colonnes ? Piste : vous conduirez la même AFC en mettant en ligne supplémentaire le profil-ligne de la « population majoritaire ».\nCette question appelle plusieurs observations :\n\nLes profils-lignes correspondent à l’origine migratoire et la modalité de la population majoritaire est souvent plus proche du centre des axes par rapport aux immigrés et descendants d’immigrés qui sont davantage éclatés sur les axes.\nNumériquement, la population majoritaire est bien plus importante que celle des immigrés et des descendants : on peut le calculer avec les lignes de code ci-dessous, cette population correspond aux trois-quarts de la population.\nLa centralité de la population majoritaire et la dispersion des autres groupes est donc en fait avant tout le résultat de cette configuration démographique !\nEgalement, la population majoritaire est représentée dans à peu près tous les groupes de PCS : ce n’est pas le cas des immigrés et des descendants qui numériquement plus faibles ressortent dans des segments spécifiques du marché du travail.\n\n\nmytable&lt;-as.table(as.matrix(tab1))\n\n\ndata.frame(round(prop.table(margin.table(mytable, 1))*100,1)) # A frequencies (summed over B)\n\n                               Var1 Freq\n1                   Pop majoritaire 74.3\n2                      G1 Outre-Mer  1.1\n3                      G2 Outre-Mer  1.2\n4                        G1 Algérie  1.7\n5                        G2 Algérie  2.1\n6                  G1 Maroc/Tunisie  2.2\n7            G2 Maroc ou de Tunisie  2.0\n8             G1 Afrique sahélienne  0.7\n9             G2 Afrique sahélienne  0.4\n10 G1 Afrique guinéenne ou centrale  1.1\n11 G2 Afrique guinéenne ou centrale  0.3\n12         G1 autres pays d'Afrique  0.6\n13         G2 autres pays d'Afrique  0.3\n14               G1 Asie du Sud-est  0.3\n15               G2 Asie du Sud-est  0.4\n16    G1 Turquie ou du Moyen-Orient  0.8\n17    G2 Turquie ou du Moyen-Orient  0.4\n18                         G1 Chine  0.3\n19            G1 autres pays d'Asie  0.6\n20            G2 autres pays d'Asie  0.1\n21                      G1 Portugal  1.0\n22                      G2 Portugal  1.7\n23           G1 Espagne ou d'Italie  0.5\n24           G2 Espagne ou d'Italie  2.1\n25         G1 autres pays de l'UE27  1.1\n26         G2 autres pays de l'UE27  0.8\n27          G1 autres pays d'Europe  1.0\n28          G2 autres pays d'Europe  0.2\n29                   G1 autres pays  0.6\n30                   G2 autres pays  0.1\n\ndata.frame(round(prop.table(margin.table(mytable, 2))*100,1))  # B frequencies (summed over A)\n\n                                           Var1 Freq\n1                                  Agriculteurs  1.0\n2                                       Artisan  2.6\n3                                    Commerçant  2.3\n4            Chefs d’entreprise (&gt;=10 salariés)  0.6\n5                         Professions libérales  1.9\n6                      Cadres fonction publique  2.0\n7                     Professions scientifiques  1.7\n8              Professions info/arts/spectacles  1.2\n9                           Cadres d’entreprise  4.7\n10    Ingénieurs/cadres techniques d’entreprise  5.6\n11                       Professeurs des écoles  4.1\n12                    Prof intermédiaires santé  5.5\n13 Professions intermédiaires fonction publique  1.6\n14              Prof intermédiaires entreprises  7.9\n15                                  Techniciens  4.6\n16                                Contremaîtres  2.9\n17                   Employés fonction publique  8.3\n18                      Policiers et militaires  2.0\n19                        Employés d’entreprise  5.0\n20                         Employés de commerce  5.0\n21                  Personnels aux particuliers  7.4\n22                              Ouvriers qualif 11.3\n23                                   Chauffeurs  2.9\n24                          Ouvriers non qualif  7.1\n25                           Ouvriers agricoles  1.0\n\n\nOn peut creuser cette analyse en retirant la population majoritaire de l’analyse, par exemple en mettant ce profil-ligne en supplémentaire. En ce cas, on étudie la segmentation du marché du travail en regardant les immigrés et les descendants les uns par rapport aux autres et non par rapport à la population majoritaire.\n\nres.afc2&lt;-CA(tab1,row.sup=1,graph=F)\n\nrowcontrib1&lt;-rownames(res.afc2$row$contrib)[res.afc2$row$contrib[,1]&gt;100/nrow(tab1)]\ncolcontrib1&lt;-rownames(res.afc2$col$contrib)[res.afc2$col$contrib[,1]&gt;100/ncol(tab1)]\nfviz_ca_biplot(res.afc2,axes=c(1,2),\n               select.row = list(name = rowcontrib1),\n               select.col=list(name=colcontrib1))\n\n\n\nrowcontrib2&lt;-rownames(res.afc2$row$contrib)[res.afc2$row$contrib[,2]&gt;100/nrow(tab1)]\ncolcontrib2&lt;-rownames(res.afc2$col$contrib)[res.afc2$col$contrib[,2]&gt;100/ncol(tab1)]\nfviz_ca_biplot(res.afc2,axes=c(1,2),\n               select.row = list(name = rowcontrib2),\n               select.col=list(name=colcontrib2))"
  },
  {
    "objectID": "CorrectionTD5.html#question-5",
    "href": "CorrectionTD5.html#question-5",
    "title": "TD5",
    "section": "",
    "text": "Ouvrez le fichier « tab2.csv ». Ce fichier contient des profils-colonnes supplémentaires renseignant le niveau de diplôme des profils-lignes. Vous conduirez une AFC où ces colonnes sont mises en « profils-lignes supplémentaires ». L’une des dimensions de segmentation du marché du travail suivant le lien à la migration est-elle associée au niveau de diplôme ?  \nLes colonnes supplémentaires sont entre les positions 26 et 33, ce qu’il faut indiquer dans la fonction CA.\nNote : ici, on inclut la population majoritaire comme profil-ligne actif.\nAvec la fonction fviz_ca_col, on voit bien que le premier axe oppose très clairement les non-diplômés aux autres. Sur le deuxième et troisième axe, le diplôme est moins structurant mais les plus diplômés ressortent quand même (en bas sur le 2e et en haut sur le 3e).\n\n###Intégrer des colonnes supplémentaires à l'analyse\nsetwd(\"E:/Enseignements/Cours UVSQ/Année 2023-2024/L3 Sociologie Analyse des données/TD/TD5\")\n\ntab2&lt;-read_csv2(\"tab2.csv\")\n\nℹ Using \"','\" as decimal and \"'.'\" as grouping mark. Use `read_delim()` for more control.\n\n\nNew names:\nRows: 30 Columns: 34\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \";\" chr\n(1): ...1 dbl (33): Agriculteurs, Artisan, Commerçant, Chefs d’entreprise (&gt;=10\nsalari...\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -&gt; `...1`\n\ntab2&lt;-column_to_rownames(tab2,var=\"...1\")\n\nrownames(tab2)\n\n [1] \"Pop majoritaire\"                  \"G1 Outre-Mer\"                    \n [3] \"G2 Outre-Mer\"                     \"G1 Algérie\"                      \n [5] \"G2 Algérie\"                       \"G1 Maroc/Tunisie\"                \n [7] \"G2 Maroc ou de Tunisie\"           \"G1 Afrique sahélienne\"           \n [9] \"G2 Afrique sahélienne\"            \"G1 Afrique guinéenne ou centrale\"\n[11] \"G2 Afrique guinéenne ou centrale\" \"G1 autres pays d'Afrique\"        \n[13] \"G2 autres pays d'Afrique\"         \"G1 Asie du Sud-est\"              \n[15] \"G2 Asie du Sud-est\"               \"G1 Turquie ou du Moyen-Orient\"   \n[17] \"G2 Turquie ou du Moyen-Orient\"    \"G1 Chine\"                        \n[19] \"G1 autres pays d'Asie\"            \"G2 autres pays d'Asie\"           \n[21] \"G1 Portugal\"                      \"G2 Portugal\"                     \n[23] \"G1 Espagne ou d'Italie\"           \"G2 Espagne ou d'Italie\"          \n[25] \"G1 autres pays de l'UE27\"         \"G2 autres pays de l'UE27\"        \n[27] \"G1 autres pays d'Europe\"          \"G2 autres pays d'Europe\"         \n[29] \"G1 autres pays\"                   \"G2 autres pays\"                  \n\ncolnames(tab2)\n\n [1] \"Agriculteurs\"                                \n [2] \"Artisan\"                                     \n [3] \"Commerçant\"                                  \n [4] \"Chefs d’entreprise (&gt;=10 salariés)\"          \n [5] \"Professions libérales\"                       \n [6] \"Cadres fonction publique\"                    \n [7] \"Professions scientifiques\"                   \n [8] \"Professions info/arts/spectacles\"            \n [9] \"Cadres d’entreprise\"                         \n[10] \"Ingénieurs/cadres techniques d’entreprise\"   \n[11] \"Professeurs des écoles\"                      \n[12] \"Prof intermédiaires santé\"                   \n[13] \"Professions intermédiaires fonction publique\"\n[14] \"Prof intermédiaires entreprises\"             \n[15] \"Techniciens\"                                 \n[16] \"Contremaîtres\"                               \n[17] \"Employés fonction publique\"                  \n[18] \"Policiers et militaires\"                     \n[19] \"Employés d’entreprise\"                       \n[20] \"Employés de commerce\"                        \n[21] \"Personnels aux particuliers\"                 \n[22] \"Ouvriers qualif\"                             \n[23] \"Chauffeurs\"                                  \n[24] \"Ouvriers non qualif\"                         \n[25] \"Ouvriers agricoles\"                          \n[26] \"Aucun diplôme\"                               \n[27] \"CEP\"                                         \n[28] \"Brevet collège\"                              \n[29] \"CAP,BEP\"                                     \n[30] \"Bac techno/pro\"                              \n[31] \"Bac général\"                                 \n[32] \"Bac+1/+2\"                                    \n[33] \"Bac&gt;=+3\"                                     \n\nres.afc3&lt;-CA(tab2,col.sup=26:33,graph=F)\n\nfviz_ca_col(res.afc3,axes=c(1,2),label=\"col.sup\")\n\n\n\nfviz_ca_col(res.afc3,axes=c(1,3),label=\"col.sup\")"
  },
  {
    "objectID": "CorrectionTD4.html",
    "href": "CorrectionTD4.html",
    "title": "TD4",
    "section": "",
    "text": "Issues de l’enquête Formation des couples menée par l’institut national des études démographiques dans les années 1980, les données analysées croisent le groupe social des hommes avec le lieu où ils ont rencontré leur conjointe. À l’aide des résultats ci-dessous, répondez aux questions suivantes :\n\nDécrivez la base de données étudiée.\nRéalisez l’analyse en justifiant l’usage de la méthode d’analyse géométrique des données à utiliser ici.\nCombien de valeurs propres faut-il retenir ? Justifez.\nInterprétez et commentez les différents axes."
  },
  {
    "objectID": "CorrectionTD4.html#section",
    "href": "CorrectionTD4.html#section",
    "title": "TD4",
    "section": "",
    "text": "Issues de l’enquête Formation des couples menée par l’institut national des études démographiques dans les années 1980, les données analysées croisent le groupe social des hommes avec le lieu où ils ont rencontré leur conjointe. À l’aide des résultats ci-dessous, répondez aux questions suivantes :\n\nDécrivez la base de données étudiée.\nRéalisez l’analyse en justifiant l’usage de la méthode d’analyse géométrique des données à utiliser ici.\nCombien de valeurs propres faut-il retenir ? Justifez.\nInterprétez et commentez les différents axes."
  },
  {
    "objectID": "CorrectionTD4.html#préparation-de-lanalyse",
    "href": "CorrectionTD4.html#préparation-de-lanalyse",
    "title": "TD4",
    "section": "Préparation de l’analyse",
    "text": "Préparation de l’analyse\nD’abord, comme d’habitude, il faut indiquer le bon répertoire de travail où se trouve la base données que nous utilisons.\n\n# Répertoire de travail \nsetwd(\"E:/Enseignements/Cours UVSQ/Année 2023-2024/L3 Sociologie Analyse des données/TD/TD4\")\n\nDans ce TD, nous utilisons les packages listés ci-dessous.\nLe package readr permet d’ouvrir la base de données.\nLe package tibble permet de faire certains recodages de la base de données facilement.\nFactoMineR est le package permettant d’utiliser les fonctions d’analyse géométrique des données (ACP, AFC…). Le package explor permet de lire facilement les résultats d’une analyse. Le package factoextra contient plusieurs fonctions utiles pour analyser les résultats d’une analyse.\n\n# Appel des packages \nlibrary(readr) \nlibrary(tibble)  \nlibrary(FactoMineR) \nlibrary(explor) \nlibrary(factoextra)\n\nLe chargement a nécessité le package : ggplot2\n\n\nWelcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\n\n\nUtilisons la fonction read_csv2 pour charger la base de données qui s’appelle “TD4.csv”. R nous dit à cette occasion qu’il y a 16 lignes et 15 colonnes dans la base, qu’une variable (PCS) est de format “chr”, donc catégorielle, les autres sont de format “dbl” donc numériques.\nLa ligne de code suivante utilise la fonction column_to_rownames du package tibble pour indiquer que la variable (colonne) PCS doit être considérée comme le libellé des lignes de la base.\n\nsetwd(\"E:/Enseignements/Cours UVSQ/Année 2023-2024/L3 Sociologie Analyse des données/TD/TD4\")\n# Lecture du fichier : on place la première colonne comme nom de lignes  \nTD4 &lt;- read_csv2(\"TD4.csv\") \n\nℹ Using \"','\" as decimal and \"'.'\" as grouping mark. Use `read_delim()` for more control.\n\n\nRows: 16 Columns: 15\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr  (1): PCS\ndbl (14): Etudes, Vacances, Fete entre amis, Association, Travail, Particuli...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n#Positionner la première colonne (nom des PCS) comme libellé des lignes (plutôt que comme colonne) \nTD4&lt;-column_to_rownames(TD4, var = \"PCS\") \n\nOn peut avoir une d’à quoi ressemble plus précisément la base avec la fonction head ou en tapant View(TD4) ce qui va ouvrir un onglet avec la base.\n\nhead(TD4)"
  },
  {
    "objectID": "CorrectionTD4.html#conduite-de-lafc",
    "href": "CorrectionTD4.html#conduite-de-lafc",
    "title": "TD4",
    "section": "Conduite de l’AFC",
    "text": "Conduite de l’AFC\nLa base est déjà prête pour l’analyse : il s’agit bien d’un tableau de contingence qui croise en ligne le groupe social des hommes (PCS) avec en colonne le lieu de rencontres du partenaire. Dans chaque cellule se trouve les effectifs. Ces données se prêtent bien à une AFC.\nOn conduit une AFC grâce à la fonction CA du package FactoMineR sur la base TD4. Les résultats de l’analyse sont stockés dans l’objet res.afc. La fonction CA nous sort automatiquement des graphiques.\n\n# Réalisation de l'AFC \nres.afc&lt;-CA(TD4)"
  },
  {
    "objectID": "CorrectionTD4.html#contribution-des-profils-lignes-et-des-profils-colonnes-sur-chacun-des-axes",
    "href": "CorrectionTD4.html#contribution-des-profils-lignes-et-des-profils-colonnes-sur-chacun-des-axes",
    "title": "TD4",
    "section": "Contribution des profils-lignes et des profils-colonnes sur chacun des axes",
    "text": "Contribution des profils-lignes et des profils-colonnes sur chacun des axes\nOn peut jeter un oeil sur les représentations géométriques mais il est aussi sage de regarder quels sont les profils-lignes et les profils-colonnes qui ont les plus fortes contributions sur chacun des axes. Ces profils qui ont une contribution supérieure à la contribution moyenne seront interprétés en priorité. En effet, les modalités des lignes et des colonnes ayant influencé le plus à la construction des axes sont celles dont les contributions sont les plus élevées. On pourra se contenter d’interpréter les résultats des modalités pour lesquelles les contributions sont supérieures à la contribution moyenne (cas où chaque profil-ligne ou profil-colonne contribuerait de manière égale à la structuration de l’axe).\nIci, il y a 16 lignes, donc la contribution moyenne des profils-lignes est de 100/16=6.25. Il y a 14 colonnes, donc la contribution moyenne des profils-colonnes est de 100/14=7.1."
  },
  {
    "objectID": "CorrectionTD4.html#interprétation-de-laxe-1",
    "href": "CorrectionTD4.html#interprétation-de-laxe-1",
    "title": "TD4",
    "section": "Interprétation de l’axe 1",
    "text": "Interprétation de l’axe 1\nLa fonction fviz_contrib permet de visualiser facilement les contributions des modalités sur les axes.\nSur l’axe 1, on interprète prioritairement les profils-lignes des cadres et professions intermédiaires de la fonction publique, des ingénieurs et cadres ou professions d’entreprises, des ouvriers non qualifiés, des professions libérales, des gros agriculteurs, des ouvriers de l’artisanat et des ouvriers de l’industrie.\n\n##Visualiser la contribution des lignes par rapport à la contribution moyenne\nfviz_contrib(res.afc,choice=\"row\",axes =1) \n\n\n\n\nSur ce même axe, on interprète prioritairement les profils-colonnes des études, du bal, des vacances et des associations (à la limite).\n\n##Visualiser la contribution des lignes par rapport à la contribution moyenne \nfviz_contrib(res.afc,choice=\"col\",axes =1) \n\n\n\n\nVoyons comment se structure alors le premier axe dans le premier plan factoriel (axes 1 et 2).\nA gauche, on trouve les groupes sociaux du bas de la hiérarchie des PCS (les ouvriers, notons qu’il s’agit ici d’une ancienne nomenclature des PCS ! l’enquête date des années 1980) et les gros agriculteurs, qui ont des profils de lieu de rencontre similaires : au bal, au spectable. A droite, ce sont des classes supérieures et moyennes de la fonction publique, qui ont rencontré leur partenaire au cours de leurs études (ce sont aussi les groupes sociaux qui en moyenne ont fait les études les plus longues…) et en vacances (justement, ce sont les groupes sociaux qui partent le plus fréquemment en vacances…).\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur l'axe 1.  \nrowcontrib1&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,1]&gt;100/16] \n\ncolcontrib1&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,1]&gt;100/14] \n\nfviz_ca_biplot(res.afc,axes=c(1,2),select.row = list(name = rowcontrib1),select.col=list(name=colcontrib1))"
  },
  {
    "objectID": "CorrectionTD4.html#interprétation-des-axes-2-et-3",
    "href": "CorrectionTD4.html#interprétation-des-axes-2-et-3",
    "title": "TD4",
    "section": "Interprétation des axes 2 et 3",
    "text": "Interprétation des axes 2 et 3\nLa même procédure peut être utilisée pour les axes 2 et 3.\nPour les profils-lignes :\n\n##Visualiser la contribution des lignes par rapport à la contribution moyenne  \nfviz_contrib(res.afc,choice=\"row\",axes =2)  \n\n\n\nfviz_contrib(res.afc,choice=\"row\",axes =3) \n\n\n\n\nPour les profils-colonnes :\n\n##Visualiser la contribution des lignes par rapport à la contribution moyenne   \nfviz_contrib(res.afc,choice=\"col\",axes =2)  \n\n\n\nfviz_contrib(res.afc,choice=\"col\",axes =3) \n\n\n\n\nVoyons comment se structure alors le premier axe dans le plan factoriel des axes 2 et 3 qui présente, on l’a déjà dit des principes d’associations secondaires par rapport à l’association principale dénotée sur le premier axe de l’analyse.\nL’axe 2 oppose les commerçants et les employés des entreprises qui rencontrent leur partenaire sur leur lieu de travail aux autres groupes sociaux. Il montre une spécificité du lieu de recontre pour ces deux groupes sociaux (par rapport aux autres professions où on se rencontre sur le temps de loisir).\nL’axe 3 oppose les gros agriculteurs et dans une moindre mesure les commerçants qui rencontrent leur partenaire par le biais d’annonces par rapport aux autres groupes sociaux (en particulier les ouvriers). C’est un axe d’opposition entre la rencontre par un médium versus par des contacts sociaux.\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur les axes 2 et 3.     \nrowcontrib2&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,2]&gt;100/16]\n\ncolcontrib2&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,2]&gt;100/14] \n\nrowcontrib3&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,3]&gt;100/16] \n\ncolcontrib3&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,3]&gt;100/14] \n\nrowcontrib23&lt;-c(rowcontrib2,rowcontrib3) \ncolcontrib23&lt;-c(colcontrib2,colcontrib3)  \n\nfviz_ca_biplot(res.afc,axes=c(2,3),select.row = list(name = rowcontrib23),select.col=list(name=colcontrib23))  \n\n\n\n\nBien sur, rien n’empêche d’utiliser également la fonction explor() pour étudier les résultats de l’analyse !\nOn peut vouloir également mettre en relation nos interprétations en calculant les probabilités conjointes, les pourcentages en lignes et en colonne sur notre tableau de contingence. On écrira :\n\nmytable&lt;-as.table(as.matrix(TD4))  \nprop.table(mytable)*100 \n# cell percentages \nprop.table(mytable, 1)*100 \n# column percentages  \nprop.table(mytable, 2)*100 \n# column percentages"
  },
  {
    "objectID": "CorrectionTD6.html",
    "href": "CorrectionTD6.html",
    "title": "TD6",
    "section": "",
    "text": "Les données se trouvent dans le fichier « tab.csv ».\nOn dispose de données départementales. Pour chaque département métropolitain, on connait les votes des premiers tours des élections présidentielles en 2017 (d’après les résultats officiels fournis par le Ministère de l’Intérieur).\n\n\nL’AFC permet d’étudier les départements qui se ressemblent et ceux qui sont les plus distincts les uns des autres en fonction des résultats électoraux. Elle permet aussi d’étudier les candidats à l’élection présidentielle, en identifiant celles et ceux qui ont des résultats similaires et distincts dans les différents départements : les candidats qui se ressemblent ont des résultats relativement plus élevés (resp. plus faibles) dans les mêmes départements (attention, on parle ici relativement).\n\n\n\nComme d’habitude, on commence par charger les packages R nécessaires à l’analyse :\n\nlibrary(\"FactoMineR\")\nlibrary(\"explor\")\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(factoextra)\nlibrary(dplyr)\nlibrary(tibble)\n\nOn peut ensuite indiquer le répertoire où sont stockées les données et charger les données. On utilise la fonction column_to_rownames pour dire à R que la première colonne (nom des départements) doit être ocnsidérée comme le nom des lignes du tableau.\n\n# Attribution du répertoire de travail : c'est l'emplacement physique oé se trouvent les jeux de données qui seront utilisés et crées\nsetwd(\"E:/Enseignements/Cours UVSQ/Année 2023-2024/L3 Sociologie Analyse des données/TD/TD6\")\n\n# AFC sur les résultats départementaux du premier tour des élections présidentielles\n# Lecture du fichier csv. \ntab&lt;-read_csv(file=\"elections.csv\",locale=locale(encoding=\"latin1\"))\ntab&lt;-column_to_rownames(tab,var=\"Départements\")\n\nOn lance l’AFC à l’aide de la fonction CA du package FactoMineR. Attention, il y a une colonne “numéro du département” qui est présente dans ce tableau. On souhaite la conserver pour la suite, mais on n’en tient pas compte ici.\n\n# Analyse factorielle des correspondances\nres.afc&lt;-CA(tab[,-1],graph=F)\n\nPour analyser l’AFC, on peut utiliser les fonctions fviz ou explor.\n\n\n\nPour le critère de Kaiser, on regarde les valeurs propres qui ont une valeur supérieure à la valeur propre moyenne :\n\nvp&lt;-res.afc$eig # On regarde lesquelles sont supérieures à l'inertie moyenne \nvp[,1]&gt;mean(vp[,1]) \n\n dim 1  dim 2  dim 3  dim 4  dim 5  dim 6  dim 7  dim 8  dim 9 dim 10 \n  TRUE   TRUE   TRUE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE \n\n\nCela nous pousserait à examiner 3 axes.\nPour le critère du coude, on peut regarder l’histogramme des valeurs propres :\n\n##Le scree plot des valeurs propres \n\nfviz_eig(res.afc,addlabels=T,ncp =10) \n\n\n\n\nOn a un premier décrochage entre la première et seconde dimension de l’AFC : la première est prépondérante. Ensuite un décrochage entre la troisième et la quatrième : il semble que trois axes aient une valeur propre importante.\n\n\n\nPar simplicité, regardons ici les deux premiers axes.\nQuelles sont les lignes (départements) et les colonnes (candidats) qui ont les plus fortes contributions sur la première dimension (contribution supérieure à la contribution moyenne) ?\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur l'axe 1. \nrowcontrib1&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,1]&gt;100/nrow(tab)]\ncolcontrib1&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,1]&gt;100/ncol(tab)]\nfviz_ca_biplot(res.afc,axes=c(1,2),\n               select.row = list(name = rowcontrib1),\n               select.col=list(name=colcontrib1))\n\n\n\n\nCet axe oppose les départements qui ont relativement davantage voté pour Macron au premier tour versus les départements qui ont davantage voté Le Pen au premier tour. Parmi les départements qui ont davantage voté Macron par rapport aux autres, ceux de l’Ile de France et de Bretagne notamment. Parmi les départements qui ont davantage voté Le Pen, ceux du Nord de la France et du sud-est.\nLe principal clivage électoral à l’échelle départementale en 2017 n’est donc pas un clivage droite-gauche, mais un clivage entre le président sortant (centriste/libéral…) et l’extrême-droite.\nMais comment les candidats de gauche et de droite se positionnent sur cet axe ? Même s’ils ont une contribution plus faible à la structuration de l’axe, on peut les projeter pour voir où ils se positionnent par rapport aux différents départements. On peut utiliser l’indicateur du cos2 (valeur entre 0 et 1) comme qualité de représentation pour voir s’ils sont plus ou moins bien représentés sur cet axe.\nA part Macron et Le Pen, Hamon est plutôt bien représenté sur cet axe, et viennent ensuite Dupont-Aignan, Arthaud et Fillon, mais qui sont nettement moins bien représentés. Les autres sont définitivement mal représentés sur cet axe (leur coordonnée est ainsi proche de l’origine).\n\ndata.frame(Axe1_cos2=sort(res.afc$col$cos2[,1],decreasing = T))\n\n                 Axe1_cos2\nLe.Pen        0.9924666859\nMacron        0.9304129092\nHamon         0.7199111798\nDupont.Aignan 0.3054563501\nArthaud       0.2407110932\nFillon        0.1490396460\nMélenchon     0.0674743898\nCheminade     0.0662298705\nPoutou        0.0110155375\nLassalle      0.0009079383\nAsselineau    0.0002071592\n\n\n\ncolcos1&lt;-rownames(res.afc$col$cos2)[res.afc$col$cos2[,1]&gt;.1]\n\nfviz_ca_col(res.afc,axes=c(1,2),select.col=list(name=colcos1))\n\n\n\n\nHamon fait des scores relativement plus élevés là où Macron fait des scores élevés. C’est aussi le cas de Fillon, même si ce n’est pas sa seule particularité. En revanche, Arthaud et Dupont-Aignan font des scores relativement plus élevés là où Le Pen fait des scores élevés, même si attention leur qualité de représentation sur l’axe est plus faible…\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur l'axe 2. \nrowcontrib2&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,2]&gt;100/nrow(tab)]\ncolcontrib2&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,2]&gt;100/ncol(tab)]\nfviz_ca_biplot(res.afc,axes=c(1,2),\n               select.row = list(name = rowcontrib2),\n               select.col=list(name=colcontrib2))\n\n\n\n\nL’axe 2 révèle un axe lié à l’ancrage géographique des candidats : Lassalle est associé au haut de l’axe 2, Fillon au bas de cet axe. Mélenchon est dans une position intermédiaire en haut de l’axe 2.\n\ndata.frame(Axe2_cos2=sort(res.afc$col$cos2[,2],decreasing = T))\n\n                 Axe2_cos2\nFillon        6.864982e-01\nMélenchon     5.409861e-01\nLassalle      3.605284e-01\nPoutou        2.164280e-01\nHamon         1.072459e-01\nDupont.Aignan 3.534046e-02\nArthaud       4.296670e-03\nAsselineau    2.723210e-03\nMacron        2.242355e-03\nCheminade     1.165384e-03\nLe.Pen        7.262012e-05\n\n\nEn plus de ces candidats qui contribuent beaucoup à l’axe, on voit que Poutou et Hamon ont aussi une plutôt bonne qualité de représentation…\n\ncolcos2&lt;-rownames(res.afc$col$cos2)[res.afc$col$cos2[,2]&gt;.1]\n\nfviz_ca_col(res.afc,axes=c(1,2),select.col=list(name=colcos2))\n\n\n\n\nMême s’ils sont positionnés de manière assez proches de l’origine sur l’axe 2, on voit que ces candidats partagent une certaine similarité dans leurs scores électoraux avec Lassalle. Pour ce dernier, sa spécificité ressort de son ancrage électoral dans les Pyrénées dont il est originaire, tandis que Fillon avait son “fief électoral dans la Sarthe, et qu’on voit bien qu’il est associé sur l’axe 2 à des départements qui sont traditionnellement plutôt de”droite” (la Vendée, les Yvelines, les Hauts de Seine…). Derrière un axe d’ancrage géographique des candidats se cache donc aussi un clivage droite-gauche sur ce second axe !\n\n\n\nUn département représentatif serait un département qui se différencie peu de l’origine sur les axes de l’analyse factorielle. Proche de l’origine, c’est un département “moyen” où les électeurs ne votent ni plus ni moins que la moyenne nationale pour les différents candidats qui ressortent sur les axes.\n\nfviz_ca_row(res.afc,axes=c(1,2),col.row=\"contrib\",pointsize=1,labelsize=3)\n\n\n\n#La coloration des départements en fonction de la contribution correspond à la contribution moyenne sur les axes 1 et 2\n\nLa figure n’est pas aisée à lire mais c’est la Charente-Maritime qui est le plus proche de l’origine sur le premier et deuxième axe. On pourra utiliser la fonction explor() pour repérer plus facilement les points sur le plan factoriel.\nAutre méthode plus robuste, car ici on a seulement regardé graphiquement le département moyen sur le premier plan factoriel. Un profil-moyen correspond à un profil qui contribue peu globalement à la dispersion des points du nuage factoriel (sur tous les axes), relativement à son poids démographique (nombre d’électeur total dans le département). En effet, on sait que dans une AFC la contribution des lignes et des colonnes dépend de leur poids (un plus grand poids correspond à une plus grande contribution, c’est d’ailleurs ce qui explique que Macron ait une contribution plus importante sur l’axe 1 que Hamon par exemple, le premier a plus d’électeurs). Donc on va chercher le département qui a la contribution à l’inertie globale du nuage des départements la plus faible, relativement à son poids dans le total des électeurs.\n\n## Poids de chaque département\npoids&lt;-res.afc$call$marge.row\n## Contribution à l'inertie de chaque département\ncontribution&lt;-res.afc$row$inertia/sum(res.afc$row$inertia)\n## Ratio contribution poids\nratio&lt;-contribution/poids\n## On affiche directement la valeur minimale du ratio\nwhich.min(ratio)\n\nCharente-Maritime \n               17 \n\n##Si on n'avait pas tenu compte du poids : \nnames(contribution)&lt;-row.names(tab)\nwhich.min(contribution)\n\nAllier \n     3 \n\n\nOn voit que relativement à son poids en nombre d’électeurs, c’est bien la Charente-Maritime qui contribue le moins à l’inertie du nuage, c’est ce département qui a le profil le plus “moyen”. Si on n’avait pas tenu compte du poids du nombre total d’électeurs, ça aurait été l’Allier, mais qui contribue peu à l’inertie du fait du faible nombre d’électeurs dans ce département…\n\n\n\nOn va utiliser des fichiers complémentaires, un fond de carte. C’est un type de données particulier qui associe des objets à des coordonnées (géodésiques) pour pouvoir représenter ces objets dans un espace. On pourra par exemple retrouver un référencement de fonds de cartes ici.\n\n###Représentation spatiale des résultats\n\n#On charge une base avec les coordonnées spatiales des départements (format shp)\nlibrary(sf)\n##Pour zoomer sur l'ile de France\nlibrary(ggmapinset)\n\nsetwd(\"E:/Enseignements/Cours UVSQ/Année 2023-2024/L3 Sociologie Analyse des données/TD/TD6/Cartographie\")\ndep &lt;- st_read(\"DEPARTEMENT.shp\")\n\nReading layer `DEPARTEMENT' from data source \n  `E:\\Enseignements\\Cours UVSQ\\Année 2023-2024\\L3 Sociologie Analyse des données\\TD\\TD6\\Cartographie\\DEPARTEMENT.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 96 features and 11 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 99217.1 ymin: 6049646 xmax: 1242417 ymax: 7110480\nProjected CRS: RGF93 v1 / Lambert-93\n\n#On crée une base avec les coordonnées sur les trois premiers axes. On indique l'id du département avec le code dans tab\ncoordafc&lt;-as.data.frame(cbind(tab$Code,res.afc$row$coord[,1:3]))\nnames(coordafc)&lt;-c(\"Code\",\"Dim1\",\"Dim2\",\"Dim3\")\ncoordafc&lt;-coordafc %&gt;% mutate_at(vars(Dim1:Dim3),as.numeric)\n#On ajoute des 0 pour les codes de département qui n'ont qu'un chiffre pour matcher avec la base de fond de carte\ncoordafc$Code&lt;-ifelse(nchar(coordafc$Code)==1,paste0(\"0\",coordafc$Code),coordafc$Code)\n##On fait une jointure avec la base du fond de carte\ndep2 &lt;- dep %&gt;% left_join(coordafc,by=c(\"CODE_DEPT\"=\"Code\"))\n\n\nd1 &lt;-  ggplot(dep2) + \n  geom_sf(aes(fill=Dim1),colour=\"darkgrey\")+\n  scale_fill_viridis_c(option=\"C\")+\n  theme_void()\nd1\n\n\n\n\nCette première carte est intéressante, mais on peut vouloir zoomer sur l’Ile de France.\n\n# Pour faire le zoom autour de Paris sur la carte:\ninset_centre &lt;- sf::st_centroid(sf::st_geometry(dep2)[dep2$NOM_DEPT == \"PARIS\"])\n\n#La même carte avec le zoom autour de Paris: \nd1&lt;-ggplot(dep2) +\n  geom_sf_inset(aes(fill = Dim1),colour=\"darkgrey\") +\n  geom_inset_frame() +\n  coord_sf_inset(inset = configure_inset(centre = inset_centre, scale = 2, units = \"mi\",\n                                         translation = c(400, 0), radius = 60))+\n  scale_fill_viridis_c(option=\"C\")+\n  labs(fill=\"Dim.1 de l'AFC\")+\n  theme_void()\nd1\n\n\n\n\nC’est mieux ! On repère ainsi les clivages électoraux résumés sur le premier axe de l’AFC.\nOn peut préférer une représentation en noir et blanc :\n\n#La même carte en noir et gris\nd1&lt;-ggplot(dep2) +\n  geom_sf_inset(aes(fill = Dim1),colour=\"darkgrey\") +\n  geom_inset_frame() +\n  coord_sf_inset(inset = configure_inset(centre = inset_centre, scale = 2, units = \"mi\",\n                                         translation = c(400, 0), radius = 60))+\n  scale_fill_gradient(low=\"black\",high=\"white\")+\n  labs(fill=\"Dim.1 de l'AFC\")+\n  theme_void()\nd1\n\n\n\n\nOn a ici représenté les coordonnées du premier axe de l’AFC sur la carte. La tonalité de l’échelle des couleurs correspond ainsi à une nuance de position entre le département le plus à gauche sur l’axe 1 et le plus à droite sur l’axe 2. On aurait pu discrétiser les coordonnées et avoir ainsi des classes de département par exemple.\nEnfin, on peut vouloir vérifier la pertinence de l’AFC en projetant les résultats électoraux bruts. Par exemple, pour le score de Macron :\n\n#On calcule d'abord le pourcentage des votes en faveur de chaque candidat par departement\n##On fait une jointure avec la base du fond de carte\n\ntabprop&lt;-as.data.frame(cbind(Code=tab$Code,tab[-1]/rowSums(tab[,-1])*100))\ntabprop$Code&lt;-ifelse(nchar(tabprop$Code)==1,paste0(\"0\",tabprop$Code),tabprop$Code)\n\ndep3 &lt;- dep %&gt;% left_join(tabprop,by=c(\"CODE_DEPT\"=\"Code\"))\n\nmacron&lt;-ggplot(dep3) +\n  geom_sf_inset(aes(fill = Macron),colour=\"darkgrey\") +\n  geom_inset_frame() +\n  coord_sf_inset(inset = configure_inset(centre = inset_centre, scale = 2, units = \"mi\",\n                                         translation = c(400, 0), radius = 60))+\n  scale_fill_viridis_c(option=\"E\",direction =-1)+\n  labs(fill=\"Vote Macron\")+\n  theme_void()\nmacron\n\n\n\n\nEt de Le Pen, on voit grossièrement que les deux candidats ont des scores élevés dans des département différents.\n\nlepen&lt;-ggplot(dep3) +\n  geom_sf_inset(aes(fill = Le.Pen),colour=\"darkgrey\") +\n  geom_inset_frame() +\n  coord_sf_inset(inset = configure_inset(centre = inset_centre, scale = 2, units = \"mi\",\n                                         translation = c(400, 0), radius = 60))+\n  scale_fill_viridis_c(direction=-1)+\n  labs(fill=\"Vote Le Pen\")+\n  theme_void()\nlepen\n\n\n\n\nNote : on s’est retenu d’interpréter ici les clivages électoraux à l’échelle des départements en fonction des propriétés socio-démographiques de ces mêmes départements qui sont importants. On pourrait par exemple étendre cette analyse en ajoutant des colonnes supplémentaires avec les caractéristiques socio-démographiques supplémentaires. Pour une analyse récente de la sociologie électorale à l’échelle des communes françaises, on pourra se reporter à Cagé, J., & Piketty, T. (2023). Une histoire du conflit politique: élections et inégalités sociales en France, 1789-2022. Paris XIXe: Éditions du Seuil."
  },
  {
    "objectID": "CorrectionTD6.html#quels-sont-les-objectifs-dune-afc-sur-un-tel-tableau-de-données",
    "href": "CorrectionTD6.html#quels-sont-les-objectifs-dune-afc-sur-un-tel-tableau-de-données",
    "title": "TD6",
    "section": "",
    "text": "L’AFC permet d’étudier les départements qui se ressemblent et ceux qui sont les plus distincts les uns des autres en fonction des résultats électoraux. Elle permet aussi d’étudier les candidats à l’élection présidentielle, en identifiant celles et ceux qui ont des résultats similaires et distincts dans les différents départements : les candidats qui se ressemblent ont des résultats relativement plus élevés (resp. plus faibles) dans les mêmes départements (attention, on parle ici relativement)."
  },
  {
    "objectID": "CorrectionTD6.html#mettre-en-oeuvre-une-afc",
    "href": "CorrectionTD6.html#mettre-en-oeuvre-une-afc",
    "title": "TD6",
    "section": "",
    "text": "Comme d’habitude, on commence par charger les packages R nécessaires à l’analyse :\n\nlibrary(\"FactoMineR\")\nlibrary(\"explor\")\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(factoextra)\nlibrary(dplyr)\nlibrary(tibble)\n\nOn peut ensuite indiquer le répertoire où sont stockées les données et charger les données. On utilise la fonction column_to_rownames pour dire à R que la première colonne (nom des départements) doit être ocnsidérée comme le nom des lignes du tableau.\n\n# Attribution du répertoire de travail : c'est l'emplacement physique oé se trouvent les jeux de données qui seront utilisés et crées\nsetwd(\"E:/Enseignements/Cours UVSQ/Année 2023-2024/L3 Sociologie Analyse des données/TD/TD6\")\n\n# AFC sur les résultats départementaux du premier tour des élections présidentielles\n# Lecture du fichier csv. \ntab&lt;-read_csv(file=\"elections.csv\",locale=locale(encoding=\"latin1\"))\ntab&lt;-column_to_rownames(tab,var=\"Départements\")\n\nOn lance l’AFC à l’aide de la fonction CA du package FactoMineR. Attention, il y a une colonne “numéro du département” qui est présente dans ce tableau. On souhaite la conserver pour la suite, mais on n’en tient pas compte ici.\n\n# Analyse factorielle des correspondances\nres.afc&lt;-CA(tab[,-1],graph=F)\n\nPour analyser l’AFC, on peut utiliser les fonctions fviz ou explor."
  },
  {
    "objectID": "CorrectionTD6.html#combien-daxes-retenir",
    "href": "CorrectionTD6.html#combien-daxes-retenir",
    "title": "TD6",
    "section": "",
    "text": "Pour le critère de Kaiser, on regarde les valeurs propres qui ont une valeur supérieure à la valeur propre moyenne :\n\nvp&lt;-res.afc$eig # On regarde lesquelles sont supérieures à l'inertie moyenne \nvp[,1]&gt;mean(vp[,1]) \n\n dim 1  dim 2  dim 3  dim 4  dim 5  dim 6  dim 7  dim 8  dim 9 dim 10 \n  TRUE   TRUE   TRUE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE \n\n\nCela nous pousserait à examiner 3 axes.\nPour le critère du coude, on peut regarder l’histogramme des valeurs propres :\n\n##Le scree plot des valeurs propres \n\nfviz_eig(res.afc,addlabels=T,ncp =10) \n\n\n\n\nOn a un premier décrochage entre la première et seconde dimension de l’AFC : la première est prépondérante. Ensuite un décrochage entre la troisième et la quatrième : il semble que trois axes aient une valeur propre importante."
  },
  {
    "objectID": "CorrectionTD6.html#interprétation-des-axes",
    "href": "CorrectionTD6.html#interprétation-des-axes",
    "title": "TD6",
    "section": "",
    "text": "Par simplicité, regardons ici les deux premiers axes.\nQuelles sont les lignes (départements) et les colonnes (candidats) qui ont les plus fortes contributions sur la première dimension (contribution supérieure à la contribution moyenne) ?\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur l'axe 1. \nrowcontrib1&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,1]&gt;100/nrow(tab)]\ncolcontrib1&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,1]&gt;100/ncol(tab)]\nfviz_ca_biplot(res.afc,axes=c(1,2),\n               select.row = list(name = rowcontrib1),\n               select.col=list(name=colcontrib1))\n\n\n\n\nCet axe oppose les départements qui ont relativement davantage voté pour Macron au premier tour versus les départements qui ont davantage voté Le Pen au premier tour. Parmi les départements qui ont davantage voté Macron par rapport aux autres, ceux de l’Ile de France et de Bretagne notamment. Parmi les départements qui ont davantage voté Le Pen, ceux du Nord de la France et du sud-est.\nLe principal clivage électoral à l’échelle départementale en 2017 n’est donc pas un clivage droite-gauche, mais un clivage entre le président sortant (centriste/libéral…) et l’extrême-droite.\nMais comment les candidats de gauche et de droite se positionnent sur cet axe ? Même s’ils ont une contribution plus faible à la structuration de l’axe, on peut les projeter pour voir où ils se positionnent par rapport aux différents départements. On peut utiliser l’indicateur du cos2 (valeur entre 0 et 1) comme qualité de représentation pour voir s’ils sont plus ou moins bien représentés sur cet axe.\nA part Macron et Le Pen, Hamon est plutôt bien représenté sur cet axe, et viennent ensuite Dupont-Aignan, Arthaud et Fillon, mais qui sont nettement moins bien représentés. Les autres sont définitivement mal représentés sur cet axe (leur coordonnée est ainsi proche de l’origine).\n\ndata.frame(Axe1_cos2=sort(res.afc$col$cos2[,1],decreasing = T))\n\n                 Axe1_cos2\nLe.Pen        0.9924666859\nMacron        0.9304129092\nHamon         0.7199111798\nDupont.Aignan 0.3054563501\nArthaud       0.2407110932\nFillon        0.1490396460\nMélenchon     0.0674743898\nCheminade     0.0662298705\nPoutou        0.0110155375\nLassalle      0.0009079383\nAsselineau    0.0002071592\n\n\n\ncolcos1&lt;-rownames(res.afc$col$cos2)[res.afc$col$cos2[,1]&gt;.1]\n\nfviz_ca_col(res.afc,axes=c(1,2),select.col=list(name=colcos1))\n\n\n\n\nHamon fait des scores relativement plus élevés là où Macron fait des scores élevés. C’est aussi le cas de Fillon, même si ce n’est pas sa seule particularité. En revanche, Arthaud et Dupont-Aignan font des scores relativement plus élevés là où Le Pen fait des scores élevés, même si attention leur qualité de représentation sur l’axe est plus faible…\n\n##Visualiser la contribution des lignes et colonnes qui ont une contribution supérieure à la contribution moyenne sur l'axe 2. \nrowcontrib2&lt;-rownames(res.afc$row$contrib)[res.afc$row$contrib[,2]&gt;100/nrow(tab)]\ncolcontrib2&lt;-rownames(res.afc$col$contrib)[res.afc$col$contrib[,2]&gt;100/ncol(tab)]\nfviz_ca_biplot(res.afc,axes=c(1,2),\n               select.row = list(name = rowcontrib2),\n               select.col=list(name=colcontrib2))\n\n\n\n\nL’axe 2 révèle un axe lié à l’ancrage géographique des candidats : Lassalle est associé au haut de l’axe 2, Fillon au bas de cet axe. Mélenchon est dans une position intermédiaire en haut de l’axe 2.\n\ndata.frame(Axe2_cos2=sort(res.afc$col$cos2[,2],decreasing = T))\n\n                 Axe2_cos2\nFillon        6.864982e-01\nMélenchon     5.409861e-01\nLassalle      3.605284e-01\nPoutou        2.164280e-01\nHamon         1.072459e-01\nDupont.Aignan 3.534046e-02\nArthaud       4.296670e-03\nAsselineau    2.723210e-03\nMacron        2.242355e-03\nCheminade     1.165384e-03\nLe.Pen        7.262012e-05\n\n\nEn plus de ces candidats qui contribuent beaucoup à l’axe, on voit que Poutou et Hamon ont aussi une plutôt bonne qualité de représentation…\n\ncolcos2&lt;-rownames(res.afc$col$cos2)[res.afc$col$cos2[,2]&gt;.1]\n\nfviz_ca_col(res.afc,axes=c(1,2),select.col=list(name=colcos2))\n\n\n\n\nMême s’ils sont positionnés de manière assez proches de l’origine sur l’axe 2, on voit que ces candidats partagent une certaine similarité dans leurs scores électoraux avec Lassalle. Pour ce dernier, sa spécificité ressort de son ancrage électoral dans les Pyrénées dont il est originaire, tandis que Fillon avait son “fief électoral dans la Sarthe, et qu’on voit bien qu’il est associé sur l’axe 2 à des départements qui sont traditionnellement plutôt de”droite” (la Vendée, les Yvelines, les Hauts de Seine…). Derrière un axe d’ancrage géographique des candidats se cache donc aussi un clivage droite-gauche sur ce second axe !"
  },
  {
    "objectID": "CorrectionTD6.html#quel-département-choisit-on-si-on-désire-faire-un-sondage-préélectoral-de-la-meilleure-qualité-possible-dans-un-département-représentatif",
    "href": "CorrectionTD6.html#quel-département-choisit-on-si-on-désire-faire-un-sondage-préélectoral-de-la-meilleure-qualité-possible-dans-un-département-représentatif",
    "title": "TD6",
    "section": "",
    "text": "Un département représentatif serait un département qui se différencie peu de l’origine sur les axes de l’analyse factorielle. Proche de l’origine, c’est un département “moyen” où les électeurs ne votent ni plus ni moins que la moyenne nationale pour les différents candidats qui ressortent sur les axes.\n\nfviz_ca_row(res.afc,axes=c(1,2),col.row=\"contrib\",pointsize=1,labelsize=3)\n\n\n\n#La coloration des départements en fonction de la contribution correspond à la contribution moyenne sur les axes 1 et 2\n\nLa figure n’est pas aisée à lire mais c’est la Charente-Maritime qui est le plus proche de l’origine sur le premier et deuxième axe. On pourra utiliser la fonction explor() pour repérer plus facilement les points sur le plan factoriel.\nAutre méthode plus robuste, car ici on a seulement regardé graphiquement le département moyen sur le premier plan factoriel. Un profil-moyen correspond à un profil qui contribue peu globalement à la dispersion des points du nuage factoriel (sur tous les axes), relativement à son poids démographique (nombre d’électeur total dans le département). En effet, on sait que dans une AFC la contribution des lignes et des colonnes dépend de leur poids (un plus grand poids correspond à une plus grande contribution, c’est d’ailleurs ce qui explique que Macron ait une contribution plus importante sur l’axe 1 que Hamon par exemple, le premier a plus d’électeurs). Donc on va chercher le département qui a la contribution à l’inertie globale du nuage des départements la plus faible, relativement à son poids dans le total des électeurs.\n\n## Poids de chaque département\npoids&lt;-res.afc$call$marge.row\n## Contribution à l'inertie de chaque département\ncontribution&lt;-res.afc$row$inertia/sum(res.afc$row$inertia)\n## Ratio contribution poids\nratio&lt;-contribution/poids\n## On affiche directement la valeur minimale du ratio\nwhich.min(ratio)\n\nCharente-Maritime \n               17 \n\n##Si on n'avait pas tenu compte du poids : \nnames(contribution)&lt;-row.names(tab)\nwhich.min(contribution)\n\nAllier \n     3 \n\n\nOn voit que relativement à son poids en nombre d’électeurs, c’est bien la Charente-Maritime qui contribue le moins à l’inertie du nuage, c’est ce département qui a le profil le plus “moyen”. Si on n’avait pas tenu compte du poids du nombre total d’électeurs, ça aurait été l’Allier, mais qui contribue peu à l’inertie du fait du faible nombre d’électeurs dans ce département…"
  },
  {
    "objectID": "CorrectionTD6.html#a-laide-du-script-r-fourni-représenter-sous-forme-cartographique-les-coordonnées-des-départements-sur-les-axes-retenus.",
    "href": "CorrectionTD6.html#a-laide-du-script-r-fourni-représenter-sous-forme-cartographique-les-coordonnées-des-départements-sur-les-axes-retenus.",
    "title": "TD6",
    "section": "",
    "text": "On va utiliser des fichiers complémentaires, un fond de carte. C’est un type de données particulier qui associe des objets à des coordonnées (géodésiques) pour pouvoir représenter ces objets dans un espace. On pourra par exemple retrouver un référencement de fonds de cartes ici.\n\n###Représentation spatiale des résultats\n\n#On charge une base avec les coordonnées spatiales des départements (format shp)\nlibrary(sf)\n##Pour zoomer sur l'ile de France\nlibrary(ggmapinset)\n\nsetwd(\"E:/Enseignements/Cours UVSQ/Année 2023-2024/L3 Sociologie Analyse des données/TD/TD6/Cartographie\")\ndep &lt;- st_read(\"DEPARTEMENT.shp\")\n\nReading layer `DEPARTEMENT' from data source \n  `E:\\Enseignements\\Cours UVSQ\\Année 2023-2024\\L3 Sociologie Analyse des données\\TD\\TD6\\Cartographie\\DEPARTEMENT.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 96 features and 11 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 99217.1 ymin: 6049646 xmax: 1242417 ymax: 7110480\nProjected CRS: RGF93 v1 / Lambert-93\n\n#On crée une base avec les coordonnées sur les trois premiers axes. On indique l'id du département avec le code dans tab\ncoordafc&lt;-as.data.frame(cbind(tab$Code,res.afc$row$coord[,1:3]))\nnames(coordafc)&lt;-c(\"Code\",\"Dim1\",\"Dim2\",\"Dim3\")\ncoordafc&lt;-coordafc %&gt;% mutate_at(vars(Dim1:Dim3),as.numeric)\n#On ajoute des 0 pour les codes de département qui n'ont qu'un chiffre pour matcher avec la base de fond de carte\ncoordafc$Code&lt;-ifelse(nchar(coordafc$Code)==1,paste0(\"0\",coordafc$Code),coordafc$Code)\n##On fait une jointure avec la base du fond de carte\ndep2 &lt;- dep %&gt;% left_join(coordafc,by=c(\"CODE_DEPT\"=\"Code\"))\n\n\nd1 &lt;-  ggplot(dep2) + \n  geom_sf(aes(fill=Dim1),colour=\"darkgrey\")+\n  scale_fill_viridis_c(option=\"C\")+\n  theme_void()\nd1\n\n\n\n\nCette première carte est intéressante, mais on peut vouloir zoomer sur l’Ile de France.\n\n# Pour faire le zoom autour de Paris sur la carte:\ninset_centre &lt;- sf::st_centroid(sf::st_geometry(dep2)[dep2$NOM_DEPT == \"PARIS\"])\n\n#La même carte avec le zoom autour de Paris: \nd1&lt;-ggplot(dep2) +\n  geom_sf_inset(aes(fill = Dim1),colour=\"darkgrey\") +\n  geom_inset_frame() +\n  coord_sf_inset(inset = configure_inset(centre = inset_centre, scale = 2, units = \"mi\",\n                                         translation = c(400, 0), radius = 60))+\n  scale_fill_viridis_c(option=\"C\")+\n  labs(fill=\"Dim.1 de l'AFC\")+\n  theme_void()\nd1\n\n\n\n\nC’est mieux ! On repère ainsi les clivages électoraux résumés sur le premier axe de l’AFC.\nOn peut préférer une représentation en noir et blanc :\n\n#La même carte en noir et gris\nd1&lt;-ggplot(dep2) +\n  geom_sf_inset(aes(fill = Dim1),colour=\"darkgrey\") +\n  geom_inset_frame() +\n  coord_sf_inset(inset = configure_inset(centre = inset_centre, scale = 2, units = \"mi\",\n                                         translation = c(400, 0), radius = 60))+\n  scale_fill_gradient(low=\"black\",high=\"white\")+\n  labs(fill=\"Dim.1 de l'AFC\")+\n  theme_void()\nd1\n\n\n\n\nOn a ici représenté les coordonnées du premier axe de l’AFC sur la carte. La tonalité de l’échelle des couleurs correspond ainsi à une nuance de position entre le département le plus à gauche sur l’axe 1 et le plus à droite sur l’axe 2. On aurait pu discrétiser les coordonnées et avoir ainsi des classes de département par exemple.\nEnfin, on peut vouloir vérifier la pertinence de l’AFC en projetant les résultats électoraux bruts. Par exemple, pour le score de Macron :\n\n#On calcule d'abord le pourcentage des votes en faveur de chaque candidat par departement\n##On fait une jointure avec la base du fond de carte\n\ntabprop&lt;-as.data.frame(cbind(Code=tab$Code,tab[-1]/rowSums(tab[,-1])*100))\ntabprop$Code&lt;-ifelse(nchar(tabprop$Code)==1,paste0(\"0\",tabprop$Code),tabprop$Code)\n\ndep3 &lt;- dep %&gt;% left_join(tabprop,by=c(\"CODE_DEPT\"=\"Code\"))\n\nmacron&lt;-ggplot(dep3) +\n  geom_sf_inset(aes(fill = Macron),colour=\"darkgrey\") +\n  geom_inset_frame() +\n  coord_sf_inset(inset = configure_inset(centre = inset_centre, scale = 2, units = \"mi\",\n                                         translation = c(400, 0), radius = 60))+\n  scale_fill_viridis_c(option=\"E\",direction =-1)+\n  labs(fill=\"Vote Macron\")+\n  theme_void()\nmacron\n\n\n\n\nEt de Le Pen, on voit grossièrement que les deux candidats ont des scores élevés dans des département différents.\n\nlepen&lt;-ggplot(dep3) +\n  geom_sf_inset(aes(fill = Le.Pen),colour=\"darkgrey\") +\n  geom_inset_frame() +\n  coord_sf_inset(inset = configure_inset(centre = inset_centre, scale = 2, units = \"mi\",\n                                         translation = c(400, 0), radius = 60))+\n  scale_fill_viridis_c(direction=-1)+\n  labs(fill=\"Vote Le Pen\")+\n  theme_void()\nlepen\n\n\n\n\nNote : on s’est retenu d’interpréter ici les clivages électoraux à l’échelle des départements en fonction des propriétés socio-démographiques de ces mêmes départements qui sont importants. On pourrait par exemple étendre cette analyse en ajoutant des colonnes supplémentaires avec les caractéristiques socio-démographiques supplémentaires. Pour une analyse récente de la sociologie électorale à l’échelle des communes françaises, on pourra se reporter à Cagé, J., & Piketty, T. (2023). Une histoire du conflit politique: élections et inégalités sociales en France, 1789-2022. Paris XIXe: Éditions du Seuil."
  }
]